Return-Path: <linux-cifs-owner@vger.kernel.org>
X-Original-To: lists+linux-cifs@lfdr.de
Delivered-To: lists+linux-cifs@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id ACC7530EE0D
	for <lists+linux-cifs@lfdr.de>; Thu,  4 Feb 2021 09:11:18 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S234027AbhBDIKV (ORCPT <rfc822;lists+linux-cifs@lfdr.de>);
        Thu, 4 Feb 2021 03:10:21 -0500
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:57600 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S230252AbhBDIKU (ORCPT
        <rfc822;linux-cifs@vger.kernel.org>); Thu, 4 Feb 2021 03:10:20 -0500
Received: from mail-yb1-xb2f.google.com (mail-yb1-xb2f.google.com [IPv6:2607:f8b0:4864:20::b2f])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id AE76DC061573
        for <linux-cifs@vger.kernel.org>; Thu,  4 Feb 2021 00:09:40 -0800 (PST)
Received: by mail-yb1-xb2f.google.com with SMTP id i6so2325519ybq.5
        for <linux-cifs@vger.kernel.org>; Thu, 04 Feb 2021 00:09:40 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20161025;
        h=mime-version:from:date:message-id:subject:to;
        bh=EIFMkqfSvXSkCMbL5tkuLZaXI3HHRxEkmiNoyrtvROo=;
        b=Qw/t2gM8gIF/PwLssp9aPlhYvz5EOaP9PwfJob6PcsUT6QJ3a04+3yjTVx3SWbUj2H
         5xE6tI9YWY7yvbNbvn46S7F37tkhSAtV+xZqHkuEY+Lj7SfNk28KKQEpSxUaCoe3jr0/
         edAEi4FIPTFXaKBodN7q7zKjijItD8rat/tzM6dNxt+qsCmxHU8xz/+BtRHkGJLC4UJ6
         JdymFu8lomKZDFJ7uJcLJOxFWTS5zniLo8382ADJgCTo/F9DJ34DRKgWY1AEQ5A/rHPO
         Ry4EVCuV8ILxxwS6Wp0msbOCGPrzz3zb2gMB6OyLK+r0HU50zymGcCx4NYaE5RhAafu4
         aqyA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:mime-version:from:date:message-id:subject:to;
        bh=EIFMkqfSvXSkCMbL5tkuLZaXI3HHRxEkmiNoyrtvROo=;
        b=QYML41M5jlEgf5O5B6A5IrkEAe8BogYCS6Myqk1fllsee+3hZ2gIophvtFc3Q0ZpHY
         lpj8LvWnghMf+Ne1wNUJDCg3w+rKj7125V2J5WJUwSih2lAb8VPJPgw5D5H5mPXrSupC
         JQMkPvPJwYKRI5VXrm/tdu7b3yRwB1I3Luwecr+TfqDyrgobpRvTbXJedjeEy6mW3nCA
         rV+ecDarJCZcRi5ISVEt7C1XD10+7H2ANbjyEPMvqcolD5igJsflwg/nKQ/BhgBTDCvM
         5qze8hACzHfwVCgXfL5cgKvPIkMWIOenLCtg4UHZTbhwyHeGpa+ueCpDU9u9s+A17ciK
         s9CA==
X-Gm-Message-State: AOAM531RsgiE7HIpEjpRanRJkS6IB6ePIabPFwkZFGT7OfwOyU4nxno/
        hXm09i2a2GIj+bYh6tzASHGkg8GqMLdQP/PcF8E=
X-Google-Smtp-Source: ABdhPJy3Or8clBYsRmvixXEO2OR/AkkysEO5e5g1P0VkoKU+R2hgqCXrIJDw9g22w/lfQMUAKBTh4rsOteoUsWow6Pc=
X-Received: by 2002:a25:ce92:: with SMTP id x140mr10505001ybe.327.1612426180035;
 Thu, 04 Feb 2021 00:09:40 -0800 (PST)
MIME-Version: 1.0
From:   Shyam Prasad N <nspmangalore@gmail.com>
Date:   Thu, 4 Feb 2021 00:09:29 -0800
Message-ID: <CANT5p=rUagVpf1aKEDVqL-DiY2+ceYUE7mLD1pGrajN-uopRig@mail.gmail.com>
Subject: [PATCH 3/4] cifs: Identify a connection by a conn_id.
To:     Steve French <smfrench@gmail.com>,
        CIFS <linux-cifs@vger.kernel.org>
Content-Type: multipart/mixed; boundary="000000000000b01c3705ba7e39eb"
Precedence: bulk
List-ID: <linux-cifs.vger.kernel.org>
X-Mailing-List: linux-cifs@vger.kernel.org

--000000000000b01c3705ba7e39eb
Content-Type: text/plain; charset="UTF-8"

-- 
Regards,
Shyam

--000000000000b01c3705ba7e39eb
Content-Type: application/octet-stream; 
	name="0003-cifs-Identify-a-connection-by-a-conn_id.patch"
Content-Disposition: attachment; 
	filename="0003-cifs-Identify-a-connection-by-a-conn_id.patch"
Content-Transfer-Encoding: base64
Content-ID: <f_kkqkw10q0>
X-Attachment-Id: f_kkqkw10q0

RnJvbSBjNzllYmU4YmY4ZGJlNzU3ZDhmMmI2NGZhNjY4NjE5OGE4MzU5NmY2IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBTaHlhbSBQcmFzYWQgTiA8c3ByYXNhZEBtaWNyb3NvZnQuY29t
PgpEYXRlOiBXZWQsIDMgRmViIDIwMjEgMjM6MjA6NDYgLTA4MDAKU3ViamVjdDogW1BBVENIIDMv
NF0gY2lmczogSWRlbnRpZnkgYSBjb25uZWN0aW9uIGJ5IGEgY29ubl9pZC4KCkludHJvZHVjZWQg
YSBuZXcgZmllbGQgY29ubl9pZCBpbiBUQ1BfU2VydmVyX0luZm8gc3RydWN0dXJlLgpUaGlzIGlz
IGEgbm9uLXBlcnNpc3RlbnQgdW5pcXVlIGlkZW50aWZpZXIgbWFpbnRhaW5lZCBieSB0aGUgY2xp
ZW50CmZvciBhIGNvbm5lY3Rpb24gdG8gYSBmaWxlIHNlcnZlci4gRm9yIHRoaXMsIGEgZ2xvYmFs
IGNvdW50ZXIgbmFtZWQKdGNwU2VzTmV4dElkIGlzIG1haW50YWluZWQuIE9uIGFsbG9jYXRpbmcg
YSBuZXcgVENQX1NlcnZlcl9JbmZvLAp0aGlzIGNvdW50ZXIgaXMgaW5jcmVtZW50ZWQgYW5kIGFz
c2lnbmVkLgoKQ2hhbmdlZCB0aGUgZHluYW1pYyB0cmFjZXBvaW50cyByZWxhdGVkIHRvIHJlY29u
bmVjdHMgYW5kCmNyZWRpdGluZyB0byBiZSBtb3JlIGluZm9ybWF0aXZlICh3aXRoIGNvbm5faWQg
cHJpbnRlZCkuCkRlYnVnZ2luZyBhIGNyZWRpdGluZyBpc3N1ZSBoZWxwZWQgbWUgdW5kZXJzdGFu
ZCB0aGUKaW1wb3J0YW50IHRoaW5ncyB0byBwcmludCBoZXJlLgoKQWx3YXlzIGNhbGwgZHluYW1p
YyB0cmFjZXBvaW50cyBvdXRzaWRlIHRoZSBzY29wZSBvZiBzcGlubG9ja3MuClRvIGRvIHRoaXMs
IGNvcHkgb3V0IHRoZSBjcmVkaXRzIGFuZCBpbl9mbGlnaHQgZmllbGRzIG9mIHRoZQpzZXJ2ZXIg
c3RydWN0IGJlZm9yZSBkcm9wcGluZyB0aGUgbG9jay4KClNpZ25lZC1vZmYtYnk6IFNoeWFtIFBy
YXNhZCBOIDxzcHJhc2FkQG1pY3Jvc29mdC5jb20+Ci0tLQogZnMvY2lmcy9jaWZzZnMuYyAgICB8
ICAxICsKIGZzL2NpZnMvY2lmc2dsb2IuaCAgfCAgMiArKwogZnMvY2lmcy9jb25uZWN0LmMgICB8
IDExICsrKysrLS0tCiBmcy9jaWZzL3NtYjJvcHMuYyAgIHwgNjIgKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tCiBmcy9jaWZzL3RyYWNlLmggICAgIHwgMzYgKysr
KysrKysrKysrKysrKysrLS0tLS0tLS0KIGZzL2NpZnMvdHJhbnNwb3J0LmMgfCA0NCArKysrKysr
KysrKysrKysrKysrKysrKystLS0tLS0tLQogNiBmaWxlcyBjaGFuZ2VkLCAxMTIgaW5zZXJ0aW9u
cygrKSwgNDQgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZnMvY2lmcy9jaWZzZnMuYyBiL2Zz
L2NpZnMvY2lmc2ZzLmMKaW5kZXggZTQ2ZGE1MzZlZDMzLi4yMDcwZjJkNDg1NjMgMTAwNjQ0Ci0t
LSBhL2ZzL2NpZnMvY2lmc2ZzLmMKKysrIGIvZnMvY2lmcy9jaWZzZnMuYwpAQCAtMTUyNSw2ICsx
NTI1LDcgQEAgaW5pdF9jaWZzKHZvaWQpCiAgKi8KIAlhdG9taWNfc2V0KCZzZXNJbmZvQWxsb2ND
b3VudCwgMCk7CiAJYXRvbWljX3NldCgmdGNvbkluZm9BbGxvY0NvdW50LCAwKTsKKwlhdG9taWNf
c2V0KCZ0Y3BTZXNOZXh0SWQsIDApOwogCWF0b21pY19zZXQoJnRjcFNlc0FsbG9jQ291bnQsIDAp
OwogCWF0b21pY19zZXQoJnRjcFNlc1JlY29ubmVjdENvdW50LCAwKTsKIAlhdG9taWNfc2V0KCZ0
Y29uSW5mb1JlY29ubmVjdENvdW50LCAwKTsKZGlmZiAtLWdpdCBhL2ZzL2NpZnMvY2lmc2dsb2Iu
aCBiL2ZzL2NpZnMvY2lmc2dsb2IuaAppbmRleCAxYTFmOWY0YWU4MGEuLjI2MzQ5MTgwZGM4YSAx
MDA2NDQKLS0tIGEvZnMvY2lmcy9jaWZzZ2xvYi5oCisrKyBiL2ZzL2NpZnMvY2lmc2dsb2IuaApA
QCAtNTc3LDYgKzU3Nyw3IEBAIGluY19yZmMxMDAxX2xlbih2b2lkICpidWYsIGludCBjb3VudCkK
IHN0cnVjdCBUQ1BfU2VydmVyX0luZm8gewogCXN0cnVjdCBsaXN0X2hlYWQgdGNwX3Nlc19saXN0
OwogCXN0cnVjdCBsaXN0X2hlYWQgc21iX3Nlc19saXN0OworCV9fdTY0IGNvbm5faWQ7IC8qIGNv
bm5lY3Rpb24gaWRlbnRpZmllciAodXNlZnVsIGZvciBkZWJ1Z2dpbmcpICovCiAJaW50IHNydl9j
b3VudDsgLyogcmVmZXJlbmNlIGNvdW50ZXIgKi8KIAkvKiAxNSBjaGFyYWN0ZXIgc2VydmVyIG5h
bWUgKyAweDIwIDE2dGggYnl0ZSBpbmRpY2F0aW5nIHR5cGUgPSBzcnYgKi8KIAljaGFyIHNlcnZl
cl9SRkMxMDAxX25hbWVbUkZDMTAwMV9OQU1FX0xFTl9XSVRIX05VTExdOwpAQCAtMTg0NSw2ICsx
ODQ2LDcgQEAgR0xPQkFMX0VYVEVSTiBzcGlubG9ja190IEdsb2JhbE1pZF9Mb2NrOyAgLyogcHJv
dGVjdHMgYWJvdmUgJiBsaXN0IG9wZXJhdGlvbnMgKi8KICAqLwogR0xPQkFMX0VYVEVSTiBhdG9t
aWNfdCBzZXNJbmZvQWxsb2NDb3VudDsKIEdMT0JBTF9FWFRFUk4gYXRvbWljX3QgdGNvbkluZm9B
bGxvY0NvdW50OworR0xPQkFMX0VYVEVSTiBhdG9taWNfdCB0Y3BTZXNOZXh0SWQ7CiBHTE9CQUxf
RVhURVJOIGF0b21pY190IHRjcFNlc0FsbG9jQ291bnQ7CiBHTE9CQUxfRVhURVJOIGF0b21pY190
IHRjcFNlc1JlY29ubmVjdENvdW50OwogR0xPQkFMX0VYVEVSTiBhdG9taWNfdCB0Y29uSW5mb1Jl
Y29ubmVjdENvdW50OwpkaWZmIC0tZ2l0IGEvZnMvY2lmcy9jb25uZWN0LmMgYi9mcy9jaWZzL2Nv
bm5lY3QuYwppbmRleCAxMGZlNmQ2ZDJkZWUuLjY4Mzk2Y2E0OWQyZiAxMDA2NDQKLS0tIGEvZnMv
Y2lmcy9jb25uZWN0LmMKKysrIGIvZnMvY2lmcy9jb25uZWN0LmMKQEAgLTI0Miw3ICsyNDIsNyBA
QCBjaWZzX3JlY29ubmVjdChzdHJ1Y3QgVENQX1NlcnZlcl9JbmZvICpzZXJ2ZXIpCiAJc2VydmVy
LT5tYXhfcmVhZCA9IDA7CiAKIAljaWZzX2RiZyhGWUksICJNYXJrIHRjcCBzZXNzaW9uIGFzIG5l
ZWQgcmVjb25uZWN0XG4iKTsKLQl0cmFjZV9zbWIzX3JlY29ubmVjdChzZXJ2ZXItPkN1cnJlbnRN
aWQsIHNlcnZlci0+aG9zdG5hbWUpOworCXRyYWNlX3NtYjNfcmVjb25uZWN0KHNlcnZlci0+Q3Vy
cmVudE1pZCwgc2VydmVyLT5jb25uX2lkLCBzZXJ2ZXItPmhvc3RuYW1lKTsKIAogCS8qIGJlZm9y
ZSByZWNvbm5lY3RpbmcgdGhlIHRjcCBzZXNzaW9uLCBtYXJrIHRoZSBzbWIgc2Vzc2lvbiAodWlk
KQogCQlhbmQgdGhlIHRpZCBiYWQgc28gdGhleSBhcmUgbm90IHVzZWQgdW50aWwgcmVjb25uZWN0
ZWQgKi8KQEAgLTg0Niw3ICs4NDYsNyBAQCBzdGF0aWMgdm9pZAogc21iMl9hZGRfY3JlZGl0c19m
cm9tX2hkcihjaGFyICpidWZmZXIsIHN0cnVjdCBUQ1BfU2VydmVyX0luZm8gKnNlcnZlcikKIHsK
IAlzdHJ1Y3Qgc21iMl9zeW5jX2hkciAqc2hkciA9IChzdHJ1Y3Qgc21iMl9zeW5jX2hkciAqKWJ1
ZmZlcjsKLQlpbnQgc2NyZWRpdHMgPSBzZXJ2ZXItPmNyZWRpdHM7CisJaW50IHNjcmVkaXRzLCBz
aW5fZmxpZ2h0OwogCiAJLyoKIAkgKiBTTUIxIGRvZXMgbm90IHVzZSBjcmVkaXRzLgpAQCAtODU3
LDEyICs4NTcsMTQgQEAgc21iMl9hZGRfY3JlZGl0c19mcm9tX2hkcihjaGFyICpidWZmZXIsIHN0
cnVjdCBUQ1BfU2VydmVyX0luZm8gKnNlcnZlcikKIAlpZiAoc2hkci0+Q3JlZGl0UmVxdWVzdCkg
ewogCQlzcGluX2xvY2soJnNlcnZlci0+cmVxX2xvY2spOwogCQlzZXJ2ZXItPmNyZWRpdHMgKz0g
bGUxNl90b19jcHUoc2hkci0+Q3JlZGl0UmVxdWVzdCk7CisJCXNjcmVkaXRzID0gc2VydmVyLT5j
cmVkaXRzOworCQlzaW5fZmxpZ2h0ID0gc2VydmVyLT5pbl9mbGlnaHQ7CiAJCXNwaW5fdW5sb2Nr
KCZzZXJ2ZXItPnJlcV9sb2NrKTsKIAkJd2FrZV91cCgmc2VydmVyLT5yZXF1ZXN0X3EpOwogCiAJ
CXRyYWNlX3NtYjNfYWRkX2NyZWRpdHMoc2VydmVyLT5DdXJyZW50TWlkLAotCQkJCXNlcnZlci0+
aG9zdG5hbWUsIHNjcmVkaXRzLAotCQkJCWxlMTZfdG9fY3B1KHNoZHItPkNyZWRpdFJlcXVlc3Qp
KTsKKwkJCQlzZXJ2ZXItPmNvbm5faWQsIHNlcnZlci0+aG9zdG5hbWUsIHNjcmVkaXRzLAorCQkJ
CWxlMTZfdG9fY3B1KHNoZHItPkNyZWRpdFJlcXVlc3QpLCBzaW5fZmxpZ2h0KTsKIAkJY2lmc19z
ZXJ2ZXJfZGJnKEZZSSwgIiVzOiBhZGRlZCAldSBjcmVkaXRzIHRvdGFsPSVkXG4iLAogCQkJCV9f
ZnVuY19fLCBsZTE2X3RvX2NwdShzaGRyLT5DcmVkaXRSZXF1ZXN0KSwKIAkJCQlzY3JlZGl0cyk7
CkBAIC0xMzE3LDYgKzEzMTksNyBAQCBjaWZzX2dldF90Y3Bfc2Vzc2lvbihzdHJ1Y3Qgc21iM19m
c19jb250ZXh0ICpjdHgpCiAJCWdvdG8gb3V0X2Vycl9jcnlwdG9fcmVsZWFzZTsKIAl9CiAKKwl0
Y3Bfc2VzLT5jb25uX2lkID0gYXRvbWljX2luY19yZXR1cm4oJnRjcFNlc05leHRJZCk7CiAJdGNw
X3Nlcy0+bm9ibG9ja2NudCA9IGN0eC0+cm9vdGZzOwogCXRjcF9zZXMtPm5vYmxvY2tzbmQgPSBj
dHgtPm5vYmxvY2tzbmQgfHwgY3R4LT5yb290ZnM7CiAJdGNwX3Nlcy0+bm9hdXRvdHVuZSA9IGN0
eC0+bm9hdXRvdHVuZTsKZGlmZiAtLWdpdCBhL2ZzL2NpZnMvc21iMm9wcy5jIGIvZnMvY2lmcy9z
bWIyb3BzLmMKaW5kZXggZjE5Mjc0ODU3MjkyLi5jNGIxZjdkYWIyNTAgMTAwNjQ0Ci0tLSBhL2Zz
L2NpZnMvc21iMm9wcy5jCisrKyBiL2ZzL2NpZnMvc21iMm9wcy5jCkBAIC02MywxNyArNjMsMTkg
QEAgc21iMl9hZGRfY3JlZGl0cyhzdHJ1Y3QgVENQX1NlcnZlcl9JbmZvICpzZXJ2ZXIsCiAJCSBj
b25zdCBzdHJ1Y3QgY2lmc19jcmVkaXRzICpjcmVkaXRzLCBjb25zdCBpbnQgb3B0eXBlKQogewog
CWludCAqdmFsLCByYyA9IC0xOworCWludCBzY3JlZGl0cywgc2luX2ZsaWdodDsKIAl1bnNpZ25l
ZCBpbnQgYWRkID0gY3JlZGl0cy0+dmFsdWU7CiAJdW5zaWduZWQgaW50IGluc3RhbmNlID0gY3Jl
ZGl0cy0+aW5zdGFuY2U7CiAJYm9vbCByZWNvbm5lY3RfZGV0ZWN0ZWQgPSBmYWxzZTsKKwlib29s
IHJlY29ubmVjdF93aXRoX2ludmFsaWRfY3JlZGl0cyA9IGZhbHNlOwogCiAJc3Bpbl9sb2NrKCZz
ZXJ2ZXItPnJlcV9sb2NrKTsKIAl2YWwgPSBzZXJ2ZXItPm9wcy0+Z2V0X2NyZWRpdHNfZmllbGQo
c2VydmVyLCBvcHR5cGUpOwogCiAJLyogZWcgZm91bmQgY2FzZSB3aGVyZSB3cml0ZSBvdmVybGFw
cGluZyByZWNvbm5lY3QgbWVzc2VkIHVwIGNyZWRpdHMgKi8KIAlpZiAoKChvcHR5cGUgJiBDSUZT
X09QX01BU0spID09IENJRlNfTkVHX09QKSAmJiAoKnZhbCAhPSAwKSkKLQkJdHJhY2Vfc21iM19y
ZWNvbm5lY3Rfd2l0aF9pbnZhbGlkX2NyZWRpdHMoc2VydmVyLT5DdXJyZW50TWlkLAotCQkJc2Vy
dmVyLT5ob3N0bmFtZSwgKnZhbCwgYWRkKTsKKwkJcmVjb25uZWN0X3dpdGhfaW52YWxpZF9jcmVk
aXRzID0gdHJ1ZTsKKwogCWlmICgoaW5zdGFuY2UgPT0gMCkgfHwgKGluc3RhbmNlID09IHNlcnZl
ci0+cmVjb25uZWN0X2luc3RhbmNlKSkKIAkJKnZhbCArPSBhZGQ7CiAJZWxzZQpAQCAtOTcsMTcg
Kzk5LDI1IEBAIHNtYjJfYWRkX2NyZWRpdHMoc3RydWN0IFRDUF9TZXJ2ZXJfSW5mbyAqc2VydmVy
LAogCQkJc2VydmVyLT5vcGxvY2tfY3JlZGl0cysrOwogCQl9CiAJfQorCXNjcmVkaXRzID0gKnZh
bDsKKwlzaW5fZmxpZ2h0ID0gc2VydmVyLT5pbl9mbGlnaHQ7CiAJc3Bpbl91bmxvY2soJnNlcnZl
ci0+cmVxX2xvY2spOwogCXdha2VfdXAoJnNlcnZlci0+cmVxdWVzdF9xKTsKIAogCWlmIChyZWNv
bm5lY3RfZGV0ZWN0ZWQpIHsKKwkJdHJhY2Vfc21iM19yZWNvbm5lY3RfZGV0ZWN0ZWQoc2VydmVy
LT5DdXJyZW50TWlkLAorCQkJc2VydmVyLT5jb25uX2lkLCBzZXJ2ZXItPmhvc3RuYW1lLCBzY3Jl
ZGl0cywgYWRkLCBzaW5fZmxpZ2h0KTsKKwogCQljaWZzX2RiZyhGWUksICJ0cnlpbmcgdG8gcHV0
ICVkIGNyZWRpdHMgZnJvbSB0aGUgb2xkIHNlcnZlciBpbnN0YW5jZSAlZFxuIiwKIAkJCSBhZGQs
IGluc3RhbmNlKTsKIAl9CiAKLQlpZiAoc2VydmVyLT50Y3BTdGF0dXMgPT0gQ2lmc05lZWRSZWNv
bm5lY3QKLQkgICAgfHwgc2VydmVyLT50Y3BTdGF0dXMgPT0gQ2lmc0V4aXRpbmcpCi0JCXJldHVy
bjsKKwlpZiAocmVjb25uZWN0X3dpdGhfaW52YWxpZF9jcmVkaXRzKSB7CisJCXRyYWNlX3NtYjNf
cmVjb25uZWN0X3dpdGhfaW52YWxpZF9jcmVkaXRzKHNlcnZlci0+Q3VycmVudE1pZCwKKwkJCXNl
cnZlci0+Y29ubl9pZCwgc2VydmVyLT5ob3N0bmFtZSwgc2NyZWRpdHMsIGFkZCwgc2luX2ZsaWdo
dCk7CisJCWNpZnNfZGJnKEZZSSwgIk5lZ290aWF0ZSBvcGVyYXRpb24gd2hlbiBzZXJ2ZXIgY3Jl
ZGl0cyBpcyBub24temVyby4gT3B0eXBlOiAlZCwgc2VydmVyIGNyZWRpdHM6ICVkLCBjcmVkaXRz
IGFkZGVkOiAlZFxuIiwKKwkJCSBvcHR5cGUsIHNjcmVkaXRzLCBhZGQpOworCX0KIAogCXN3aXRj
aCAocmMpIHsKIAljYXNlIC0xOgpAQCAtMTIzLDIzICsxMzMsMzAgQEAgc21iMl9hZGRfY3JlZGl0
cyhzdHJ1Y3QgVENQX1NlcnZlcl9JbmZvICpzZXJ2ZXIsCiAJCWNpZnNfZGJnKEZZSSwgImRpc2Fi
bGluZyBvcGxvY2tzXG4iKTsKIAkJYnJlYWs7CiAJZGVmYXVsdDoKLQkJdHJhY2Vfc21iM19hZGRf
Y3JlZGl0cyhzZXJ2ZXItPkN1cnJlbnRNaWQsCi0JCQlzZXJ2ZXItPmhvc3RuYW1lLCByYywgYWRk
KTsKLQkJY2lmc19kYmcoRllJLCAiJXM6IGFkZGVkICV1IGNyZWRpdHMgdG90YWw9JWRcbiIsIF9f
ZnVuY19fLCBhZGQsIHJjKTsKKwkJLyogY2hhbmdlX2NvbmYgcmViYWxhbmNlZCBjcmVkaXRzIGZv
ciBkaWZmZXJlbnQgdHlwZXMgKi8KKwkJYnJlYWs7CiAJfQorCisJdHJhY2Vfc21iM19hZGRfY3Jl
ZGl0cyhzZXJ2ZXItPkN1cnJlbnRNaWQsCisJCQlzZXJ2ZXItPmNvbm5faWQsIHNlcnZlci0+aG9z
dG5hbWUsIHNjcmVkaXRzLCBhZGQsIHNpbl9mbGlnaHQpOworCWNpZnNfZGJnKEZZSSwgIiVzOiBh
ZGRlZCAldSBjcmVkaXRzIHRvdGFsPSVkXG4iLCBfX2Z1bmNfXywgYWRkLCBzY3JlZGl0cyk7CiB9
CiAKIHN0YXRpYyB2b2lkCiBzbWIyX3NldF9jcmVkaXRzKHN0cnVjdCBUQ1BfU2VydmVyX0luZm8g
KnNlcnZlciwgY29uc3QgaW50IHZhbCkKIHsKKwlpbnQgc2NyZWRpdHMsIHNpbl9mbGlnaHQ7CisK
IAlzcGluX2xvY2soJnNlcnZlci0+cmVxX2xvY2spOwogCXNlcnZlci0+Y3JlZGl0cyA9IHZhbDsK
IAlpZiAodmFsID09IDEpCiAJCXNlcnZlci0+cmVjb25uZWN0X2luc3RhbmNlKys7CisJc2NyZWRp
dHMgPSBzZXJ2ZXItPmNyZWRpdHM7CisJc2luX2ZsaWdodCA9IHNlcnZlci0+aW5fZmxpZ2h0Owog
CXNwaW5fdW5sb2NrKCZzZXJ2ZXItPnJlcV9sb2NrKTsKIAogCXRyYWNlX3NtYjNfc2V0X2NyZWRp
dHMoc2VydmVyLT5DdXJyZW50TWlkLAotCQkJc2VydmVyLT5ob3N0bmFtZSwgdmFsLCB2YWwpOwor
CQkJc2VydmVyLT5jb25uX2lkLCBzZXJ2ZXItPmhvc3RuYW1lLCBzY3JlZGl0cywgdmFsLCBzaW5f
ZmxpZ2h0KTsKIAljaWZzX2RiZyhGWUksICIlczogc2V0ICV1IGNyZWRpdHNcbiIsIF9fZnVuY19f
LCB2YWwpOwogCiAJLyogZG9uJ3QgbG9nIHdoaWxlIGhvbGRpbmcgdGhlIGxvY2sgKi8KQEAgLTE3
MSw3ICsxODgsNyBAQCBzbWIyX3dhaXRfbXR1X2NyZWRpdHMoc3RydWN0IFRDUF9TZXJ2ZXJfSW5m
byAqc2VydmVyLCB1bnNpZ25lZCBpbnQgc2l6ZSwKIAkJICAgICAgdW5zaWduZWQgaW50ICpudW0s
IHN0cnVjdCBjaWZzX2NyZWRpdHMgKmNyZWRpdHMpCiB7CiAJaW50IHJjID0gMDsKLQl1bnNpZ25l
ZCBpbnQgc2NyZWRpdHM7CisJdW5zaWduZWQgaW50IHNjcmVkaXRzLCBzaW5fZmxpZ2h0OwogCiAJ
c3Bpbl9sb2NrKCZzZXJ2ZXItPnJlcV9sb2NrKTsKIAl3aGlsZSAoMSkgewpAQCAtMjA4LDE3ICsy
MjUsMTggQEAgc21iMl93YWl0X210dV9jcmVkaXRzKHN0cnVjdCBUQ1BfU2VydmVyX0luZm8gKnNl
cnZlciwgdW5zaWduZWQgaW50IHNpemUsCiAJCQkJRElWX1JPVU5EX1VQKCpudW0sIFNNQjJfTUFY
X0JVRkZFUl9TSVpFKTsKIAkJCWNyZWRpdHMtPmluc3RhbmNlID0gc2VydmVyLT5yZWNvbm5lY3Rf
aW5zdGFuY2U7CiAJCQlzZXJ2ZXItPmNyZWRpdHMgLT0gY3JlZGl0cy0+dmFsdWU7Ci0JCQlzY3Jl
ZGl0cyA9IHNlcnZlci0+Y3JlZGl0czsKIAkJCXNlcnZlci0+aW5fZmxpZ2h0Kys7CiAJCQlpZiAo
c2VydmVyLT5pbl9mbGlnaHQgPiBzZXJ2ZXItPm1heF9pbl9mbGlnaHQpCiAJCQkJc2VydmVyLT5t
YXhfaW5fZmxpZ2h0ID0gc2VydmVyLT5pbl9mbGlnaHQ7CiAJCQlicmVhazsKIAkJfQogCX0KKwlz
Y3JlZGl0cyA9IHNlcnZlci0+Y3JlZGl0czsKKwlzaW5fZmxpZ2h0ID0gc2VydmVyLT5pbl9mbGln
aHQ7CiAJc3Bpbl91bmxvY2soJnNlcnZlci0+cmVxX2xvY2spOwogCiAJdHJhY2Vfc21iM19hZGRf
Y3JlZGl0cyhzZXJ2ZXItPkN1cnJlbnRNaWQsCi0JCQlzZXJ2ZXItPmhvc3RuYW1lLCBzY3JlZGl0
cywgLShjcmVkaXRzLT52YWx1ZSkpOworCQkJc2VydmVyLT5jb25uX2lkLCBzZXJ2ZXItPmhvc3Ru
YW1lLCBzY3JlZGl0cywgLShjcmVkaXRzLT52YWx1ZSksIHNpbl9mbGlnaHQpOwogCWNpZnNfZGJn
KEZZSSwgIiVzOiByZW1vdmVkICV1IGNyZWRpdHMgdG90YWw9JWRcbiIsCiAJCQlfX2Z1bmNfXywg
Y3JlZGl0cy0+dmFsdWUsIHNjcmVkaXRzKTsKIApAQCAtMjMxLDE0ICsyNDksMTQgQEAgc21iMl9h
ZGp1c3RfY3JlZGl0cyhzdHJ1Y3QgVENQX1NlcnZlcl9JbmZvICpzZXJ2ZXIsCiAJCSAgICBjb25z
dCB1bnNpZ25lZCBpbnQgcGF5bG9hZF9zaXplKQogewogCWludCBuZXdfdmFsID0gRElWX1JPVU5E
X1VQKHBheWxvYWRfc2l6ZSwgU01CMl9NQVhfQlVGRkVSX1NJWkUpOwotCWludCBzY3JlZGl0czsK
KwlpbnQgc2NyZWRpdHMsIHNpbl9mbGlnaHQ7CiAKIAlpZiAoIWNyZWRpdHMtPnZhbHVlIHx8IGNy
ZWRpdHMtPnZhbHVlID09IG5ld192YWwpCiAJCXJldHVybiAwOwogCiAJaWYgKGNyZWRpdHMtPnZh
bHVlIDwgbmV3X3ZhbCkgewogCQl0cmFjZV9zbWIzX3Rvb19tYW55X2NyZWRpdHMoc2VydmVyLT5D
dXJyZW50TWlkLAotCQkJCXNlcnZlci0+aG9zdG5hbWUsIDAsIGNyZWRpdHMtPnZhbHVlIC0gbmV3
X3ZhbCk7CisJCQkJc2VydmVyLT5jb25uX2lkLCBzZXJ2ZXItPmhvc3RuYW1lLCAwLCBjcmVkaXRz
LT52YWx1ZSAtIG5ld192YWwsIDApOwogCQljaWZzX3NlcnZlcl9kYmcoVkZTLCAicmVxdWVzdCBo
YXMgbGVzcyBjcmVkaXRzICglZCkgdGhhbiByZXF1aXJlZCAoJWQpIiwKIAkJCQljcmVkaXRzLT52
YWx1ZSwgbmV3X3ZhbCk7CiAKQEAgLTI0OCw5ICsyNjYsMTIgQEAgc21iMl9hZGp1c3RfY3JlZGl0
cyhzdHJ1Y3QgVENQX1NlcnZlcl9JbmZvICpzZXJ2ZXIsCiAJc3Bpbl9sb2NrKCZzZXJ2ZXItPnJl
cV9sb2NrKTsKIAogCWlmIChzZXJ2ZXItPnJlY29ubmVjdF9pbnN0YW5jZSAhPSBjcmVkaXRzLT5p
bnN0YW5jZSkgeworCQlzY3JlZGl0cyA9IHNlcnZlci0+Y3JlZGl0czsKKwkJc2luX2ZsaWdodCA9
IHNlcnZlci0+aW5fZmxpZ2h0OwogCQlzcGluX3VubG9jaygmc2VydmVyLT5yZXFfbG9jayk7CisK
IAkJdHJhY2Vfc21iM19yZWNvbm5lY3RfZGV0ZWN0ZWQoc2VydmVyLT5DdXJyZW50TWlkLAotCQkJ
c2VydmVyLT5ob3N0bmFtZSwgMCwgMCk7CisJCQlzZXJ2ZXItPmNvbm5faWQsIHNlcnZlci0+aG9z
dG5hbWUsIHNjcmVkaXRzLCBjcmVkaXRzLT52YWx1ZSAtIG5ld192YWwsIHNpbl9mbGlnaHQpOwog
CQljaWZzX3NlcnZlcl9kYmcoVkZTLCAidHJ5aW5nIHRvIHJldHVybiAlZCBjcmVkaXRzIHRvIG9s
ZCBzZXNzaW9uXG4iLAogCQkJIGNyZWRpdHMtPnZhbHVlIC0gbmV3X3ZhbCk7CiAJCXJldHVybiAt
RUFHQUlOOwpAQCAtMjU4LDE1ICsyNzksMTcgQEAgc21iMl9hZGp1c3RfY3JlZGl0cyhzdHJ1Y3Qg
VENQX1NlcnZlcl9JbmZvICpzZXJ2ZXIsCiAKIAlzZXJ2ZXItPmNyZWRpdHMgKz0gY3JlZGl0cy0+
dmFsdWUgLSBuZXdfdmFsOwogCXNjcmVkaXRzID0gc2VydmVyLT5jcmVkaXRzOworCXNpbl9mbGln
aHQgPSBzZXJ2ZXItPmluX2ZsaWdodDsKIAlzcGluX3VubG9jaygmc2VydmVyLT5yZXFfbG9jayk7
CiAJd2FrZV91cCgmc2VydmVyLT5yZXF1ZXN0X3EpOwotCWNyZWRpdHMtPnZhbHVlID0gbmV3X3Zh
bDsKIAogCXRyYWNlX3NtYjNfYWRkX2NyZWRpdHMoc2VydmVyLT5DdXJyZW50TWlkLAotCQkJc2Vy
dmVyLT5ob3N0bmFtZSwgc2NyZWRpdHMsIGNyZWRpdHMtPnZhbHVlIC0gbmV3X3ZhbCk7CisJCQlz
ZXJ2ZXItPmNvbm5faWQsIHNlcnZlci0+aG9zdG5hbWUsIHNjcmVkaXRzLCBjcmVkaXRzLT52YWx1
ZSAtIG5ld192YWwsIHNpbl9mbGlnaHQpOwogCWNpZnNfZGJnKEZZSSwgIiVzOiBhZGp1c3QgYWRk
ZWQgJXUgY3JlZGl0cyB0b3RhbD0lZFxuIiwKIAkJCV9fZnVuY19fLCBjcmVkaXRzLT52YWx1ZSAt
IG5ld192YWwsIHNjcmVkaXRzKTsKIAorCWNyZWRpdHMtPnZhbHVlID0gbmV3X3ZhbDsKKwogCXJl
dHVybiAwOwogfQogCkBAIC0yMzY5LDcgKzIzOTIsNyBAQCBzdGF0aWMgYm9vbAogc21iMl9pc19z
dGF0dXNfcGVuZGluZyhjaGFyICpidWYsIHN0cnVjdCBUQ1BfU2VydmVyX0luZm8gKnNlcnZlcikK
IHsKIAlzdHJ1Y3Qgc21iMl9zeW5jX2hkciAqc2hkciA9IChzdHJ1Y3Qgc21iMl9zeW5jX2hkciAq
KWJ1ZjsKLQlpbnQgc2NyZWRpdHM7CisJaW50IHNjcmVkaXRzLCBzaW5fZmxpZ2h0OwogCiAJaWYg
KHNoZHItPlN0YXR1cyAhPSBTVEFUVVNfUEVORElORykKIAkJcmV0dXJuIGZhbHNlOwpAQCAtMjM3
OCwxMSArMjQwMSwxMiBAQCBzbWIyX2lzX3N0YXR1c19wZW5kaW5nKGNoYXIgKmJ1Ziwgc3RydWN0
IFRDUF9TZXJ2ZXJfSW5mbyAqc2VydmVyKQogCQlzcGluX2xvY2soJnNlcnZlci0+cmVxX2xvY2sp
OwogCQlzZXJ2ZXItPmNyZWRpdHMgKz0gbGUxNl90b19jcHUoc2hkci0+Q3JlZGl0UmVxdWVzdCk7
CiAJCXNjcmVkaXRzID0gc2VydmVyLT5jcmVkaXRzOworCQlzaW5fZmxpZ2h0ID0gc2VydmVyLT5p
bl9mbGlnaHQ7CiAJCXNwaW5fdW5sb2NrKCZzZXJ2ZXItPnJlcV9sb2NrKTsKIAkJd2FrZV91cCgm
c2VydmVyLT5yZXF1ZXN0X3EpOwogCiAJCXRyYWNlX3NtYjNfYWRkX2NyZWRpdHMoc2VydmVyLT5D
dXJyZW50TWlkLAotCQkJCXNlcnZlci0+aG9zdG5hbWUsIHNjcmVkaXRzLCBsZTE2X3RvX2NwdShz
aGRyLT5DcmVkaXRSZXF1ZXN0KSk7CisJCQkJc2VydmVyLT5jb25uX2lkLCBzZXJ2ZXItPmhvc3Ru
YW1lLCBzY3JlZGl0cywgbGUxNl90b19jcHUoc2hkci0+Q3JlZGl0UmVxdWVzdCksIHNpbl9mbGln
aHQpOwogCQljaWZzX2RiZyhGWUksICIlczogc3RhdHVzIHBlbmRpbmcgYWRkICV1IGNyZWRpdHMg
dG90YWw9JWRcbiIsCiAJCQkJX19mdW5jX18sIGxlMTZfdG9fY3B1KHNoZHItPkNyZWRpdFJlcXVl
c3QpLCBzY3JlZGl0cyk7CiAJfQpkaWZmIC0tZ2l0IGEvZnMvY2lmcy90cmFjZS5oIGIvZnMvY2lm
cy90cmFjZS5oCmluZGV4IGMzZDFhNTg0ZjI1MS4uZTJlMDZlNzRlNjRlIDEwMDY0NAotLS0gYS9m
cy9jaWZzL3RyYWNlLmgKKysrIGIvZnMvY2lmcy90cmFjZS5oCkBAIC04NTEsMTcgKzg1MSwyMSBA
QCBERUZJTkVfU01CM19MRUFTRV9FUlJfRVZFTlQobGVhc2VfZXJyKTsKIAogREVDTEFSRV9FVkVO
VF9DTEFTUyhzbWIzX3JlY29ubmVjdF9jbGFzcywKIAlUUF9QUk9UTyhfX3U2NAljdXJybWlkLAor
CQlfX3U2NCBjb25uX2lkLAogCQljaGFyICpob3N0bmFtZSksCi0JVFBfQVJHUyhjdXJybWlkLCBo
b3N0bmFtZSksCisJVFBfQVJHUyhjdXJybWlkLCBjb25uX2lkLCBob3N0bmFtZSksCiAJVFBfU1RS
VUNUX19lbnRyeSgKIAkJX19maWVsZChfX3U2NCwgY3Vycm1pZCkKKwkJX19maWVsZChfX3U2NCAs
IGNvbm5faWQpCiAJCV9fZmllbGQoY2hhciAqLCBob3N0bmFtZSkKIAkpLAogCVRQX2Zhc3RfYXNz
aWduKAogCQlfX2VudHJ5LT5jdXJybWlkID0gY3Vycm1pZDsKKwkJX19lbnRyeS0+Y29ubl9pZCA9
IGNvbm5faWQ7CiAJCV9fZW50cnktPmhvc3RuYW1lID0gaG9zdG5hbWU7CiAJKSwKLQlUUF9wcmlu
dGsoInNlcnZlcj0lcyBjdXJyZW50X21pZD0weCVsbHgiLAorCVRQX3ByaW50aygiY29ubl9pZD0w
eCVsbHggc2VydmVyPSVzIGN1cnJlbnRfbWlkPSVsbHUiLAorCQlfX2VudHJ5LT5jb25uX2lkLAog
CQlfX2VudHJ5LT5ob3N0bmFtZSwKIAkJX19lbnRyeS0+Y3Vycm1pZCkKICkKQEAgLTg2OSw0NCAr
ODczLDU2IEBAIERFQ0xBUkVfRVZFTlRfQ0xBU1Moc21iM19yZWNvbm5lY3RfY2xhc3MsCiAjZGVm
aW5lIERFRklORV9TTUIzX1JFQ09OTkVDVF9FVkVOVChuYW1lKSAgICAgICAgXAogREVGSU5FX0VW
RU5UKHNtYjNfcmVjb25uZWN0X2NsYXNzLCBzbWIzXyMjbmFtZSwgIFwKIAlUUF9QUk9UTyhfX3U2
NAljdXJybWlkLAkJXAotCQljaGFyICpob3N0bmFtZSksCQlcCi0JVFBfQVJHUyhjdXJybWlkLCBo
b3N0bmFtZSkpCisJCV9fdTY0IGNvbm5faWQsCQkJXAorCQljaGFyICpob3N0bmFtZSksCQkJCVwK
KwlUUF9BUkdTKGN1cnJtaWQsIGNvbm5faWQsIGhvc3RuYW1lKSkKIAogREVGSU5FX1NNQjNfUkVD
T05ORUNUX0VWRU5UKHJlY29ubmVjdCk7CiBERUZJTkVfU01CM19SRUNPTk5FQ1RfRVZFTlQocGFy
dGlhbF9zZW5kX3JlY29ubmVjdCk7CiAKIERFQ0xBUkVfRVZFTlRfQ0xBU1Moc21iM19jcmVkaXRf
Y2xhc3MsCiAJVFBfUFJPVE8oX191NjQJY3Vycm1pZCwKKwkJX191NjQgY29ubl9pZCwKIAkJY2hh
ciAqaG9zdG5hbWUsCiAJCWludCBjcmVkaXRzLAotCQlpbnQgY3JlZGl0c190b19hZGQpLAotCVRQ
X0FSR1MoY3Vycm1pZCwgaG9zdG5hbWUsIGNyZWRpdHMsIGNyZWRpdHNfdG9fYWRkKSwKKwkJaW50
IGNyZWRpdHNfdG9fYWRkLAorCQlpbnQgaW5fZmxpZ2h0KSwKKwlUUF9BUkdTKGN1cnJtaWQsIGNv
bm5faWQsIGhvc3RuYW1lLCBjcmVkaXRzLCBjcmVkaXRzX3RvX2FkZCwgaW5fZmxpZ2h0KSwKIAlU
UF9TVFJVQ1RfX2VudHJ5KAogCQlfX2ZpZWxkKF9fdTY0LCBjdXJybWlkKQorCQlfX2ZpZWxkKF9f
dTY0ICwgY29ubl9pZCkKIAkJX19maWVsZChjaGFyICosIGhvc3RuYW1lKQogCQlfX2ZpZWxkKGlu
dCwgY3JlZGl0cykKIAkJX19maWVsZChpbnQsIGNyZWRpdHNfdG9fYWRkKQorCQlfX2ZpZWxkKGlu
dCwgaW5fZmxpZ2h0KQogCSksCiAJVFBfZmFzdF9hc3NpZ24oCiAJCV9fZW50cnktPmN1cnJtaWQg
PSBjdXJybWlkOworCQlfX2VudHJ5LT5jb25uX2lkID0gY29ubl9pZDsKIAkJX19lbnRyeS0+aG9z
dG5hbWUgPSBob3N0bmFtZTsKIAkJX19lbnRyeS0+Y3JlZGl0cyA9IGNyZWRpdHM7CiAJCV9fZW50
cnktPmNyZWRpdHNfdG9fYWRkID0gY3JlZGl0c190b19hZGQ7CisJCV9fZW50cnktPmluX2ZsaWdo
dCA9IGluX2ZsaWdodDsKIAkpLAotCVRQX3ByaW50aygic2VydmVyPSVzIGN1cnJlbnRfbWlkPTB4
JWxseCBjcmVkaXRzPSVkIGNyZWRpdHNfdG9fYWRkPSVkIiwKKwlUUF9wcmludGsoImNvbm5faWQ9
MHglbGx4IHNlcnZlcj0lcyBjdXJyZW50X21pZD0lbGx1IgorCQkJImNyZWRpdHM9JWQgY3JlZGl0
X2NoYW5nZT0lZCBpbl9mbGlnaHQ9JWQiLAorCQlfX2VudHJ5LT5jb25uX2lkLAogCQlfX2VudHJ5
LT5ob3N0bmFtZSwKIAkJX19lbnRyeS0+Y3Vycm1pZCwKIAkJX19lbnRyeS0+Y3JlZGl0cywKLQkJ
X19lbnRyeS0+Y3JlZGl0c190b19hZGQpCisJCV9fZW50cnktPmNyZWRpdHNfdG9fYWRkLAorCQlf
X2VudHJ5LT5pbl9mbGlnaHQpCiApCiAKICNkZWZpbmUgREVGSU5FX1NNQjNfQ1JFRElUX0VWRU5U
KG5hbWUpICAgICAgICBcCiBERUZJTkVfRVZFTlQoc21iM19jcmVkaXRfY2xhc3MsIHNtYjNfIyNu
YW1lLCAgXAogCVRQX1BST1RPKF9fdTY0CWN1cnJtaWQsCQlcCisJCV9fdTY0IGNvbm5faWQsCQkJ
XAogCQljaGFyICpob3N0bmFtZSwJCQlcCiAJCWludCAgY3JlZGl0cywJCQlcCi0JCWludCAgY3Jl
ZGl0c190b19hZGQpLAkJXAotCVRQX0FSR1MoY3Vycm1pZCwgaG9zdG5hbWUsIGNyZWRpdHMsIGNy
ZWRpdHNfdG9fYWRkKSkKKwkJaW50ICBjcmVkaXRzX3RvX2FkZCwJXAorCQlpbnQgaW5fZmxpZ2h0
KSwJCQlcCisJVFBfQVJHUyhjdXJybWlkLCBjb25uX2lkLCBob3N0bmFtZSwgY3JlZGl0cywgY3Jl
ZGl0c190b19hZGQsIGluX2ZsaWdodCkpCiAKIERFRklORV9TTUIzX0NSRURJVF9FVkVOVChyZWNv
bm5lY3Rfd2l0aF9pbnZhbGlkX2NyZWRpdHMpOwogREVGSU5FX1NNQjNfQ1JFRElUX0VWRU5UKHJl
Y29ubmVjdF9kZXRlY3RlZCk7CmRpZmYgLS1naXQgYS9mcy9jaWZzL3RyYW5zcG9ydC5jIGIvZnMv
Y2lmcy90cmFuc3BvcnQuYwppbmRleCAzOWU4NzcwNTg0MGQuLjcwYjljN2ViNjcyNiAxMDA2NDQK
LS0tIGEvZnMvY2lmcy90cmFuc3BvcnQuYworKysgYi9mcy9jaWZzL3RyYW5zcG9ydC5jCkBAIC00
NDUsNyArNDQ1LDcgQEAgX19zbWJfc2VuZF9ycXN0KHN0cnVjdCBUQ1BfU2VydmVyX0luZm8gKnNl
cnZlciwgaW50IG51bV9ycXN0LAogCQkgKi8KIAkJc2VydmVyLT50Y3BTdGF0dXMgPSBDaWZzTmVl
ZFJlY29ubmVjdDsKIAkJdHJhY2Vfc21iM19wYXJ0aWFsX3NlbmRfcmVjb25uZWN0KHNlcnZlci0+
Q3VycmVudE1pZCwKLQkJCQkJCSAgc2VydmVyLT5ob3N0bmFtZSk7CisJCQkJCQkgIHNlcnZlci0+
Y29ubl9pZCwgc2VydmVyLT5ob3N0bmFtZSk7CiAJfQogc21iZF9kb25lOgogCWlmIChyYyA8IDAg
JiYgcmMgIT0gLUVJTlRSKQpAQCAtNTI3LDcgKzUyNyw3IEBAIHdhaXRfZm9yX2ZyZWVfY3JlZGl0
cyhzdHJ1Y3QgVENQX1NlcnZlcl9JbmZvICpzZXJ2ZXIsIGNvbnN0IGludCBudW1fY3JlZGl0cywK
IAlpbnQgKmNyZWRpdHM7CiAJaW50IG9wdHlwZTsKIAlsb25nIGludCB0OwotCWludCBzY3JlZGl0
cyA9IHNlcnZlci0+Y3JlZGl0czsKKwlpbnQgc2NyZWRpdHMsIHNpbl9mbGlnaHQ7CiAKIAlpZiAo
dGltZW91dCA8IDApCiAJCXQgPSBNQVhfSklGRllfT0ZGU0VUOwpAQCAtNTUxLDIyICs1NTEsMzcg
QEAgd2FpdF9mb3JfZnJlZV9jcmVkaXRzKHN0cnVjdCBUQ1BfU2VydmVyX0luZm8gKnNlcnZlciwg
Y29uc3QgaW50IG51bV9jcmVkaXRzLAogCQkJc2VydmVyLT5tYXhfaW5fZmxpZ2h0ID0gc2VydmVy
LT5pbl9mbGlnaHQ7CiAJCSpjcmVkaXRzIC09IDE7CiAJCSppbnN0YW5jZSA9IHNlcnZlci0+cmVj
b25uZWN0X2luc3RhbmNlOworCQlzY3JlZGl0cyA9ICpjcmVkaXRzOworCQlzaW5fZmxpZ2h0ID0g
c2VydmVyLT5pbl9mbGlnaHQ7CiAJCXNwaW5fdW5sb2NrKCZzZXJ2ZXItPnJlcV9sb2NrKTsKKwor
CQl0cmFjZV9zbWIzX2FkZF9jcmVkaXRzKHNlcnZlci0+Q3VycmVudE1pZCwKKwkJCQlzZXJ2ZXIt
PmNvbm5faWQsIHNlcnZlci0+aG9zdG5hbWUsIHNjcmVkaXRzLCAtMSwgc2luX2ZsaWdodCk7CisJ
CWNpZnNfZGJnKEZZSSwgIiVzOiByZW1vdmUgJXUgY3JlZGl0cyB0b3RhbD0lZFxuIiwKKwkJCQlf
X2Z1bmNfXywgMSwgc2NyZWRpdHMpOworCiAJCXJldHVybiAwOwogCX0KIAogCXdoaWxlICgxKSB7
CiAJCWlmICgqY3JlZGl0cyA8IG51bV9jcmVkaXRzKSB7CisJCQlzY3JlZGl0cyA9ICpjcmVkaXRz
OwogCQkJc3Bpbl91bmxvY2soJnNlcnZlci0+cmVxX2xvY2spOworCiAJCQljaWZzX251bV93YWl0
ZXJzX2luYyhzZXJ2ZXIpOwogCQkJcmMgPSB3YWl0X2V2ZW50X2tpbGxhYmxlX3RpbWVvdXQoc2Vy
dmVyLT5yZXF1ZXN0X3EsCiAJCQkJaGFzX2NyZWRpdHMoc2VydmVyLCBjcmVkaXRzLCBudW1fY3Jl
ZGl0cyksIHQpOwogCQkJY2lmc19udW1fd2FpdGVyc19kZWMoc2VydmVyKTsKIAkJCWlmICghcmMp
IHsKKwkJCQlzcGluX2xvY2soJnNlcnZlci0+cmVxX2xvY2spOworCQkJCXNjcmVkaXRzID0gKmNy
ZWRpdHM7CisJCQkJc2luX2ZsaWdodCA9IHNlcnZlci0+aW5fZmxpZ2h0OworCQkJCXNwaW5fdW5s
b2NrKCZzZXJ2ZXItPnJlcV9sb2NrKTsKKwogCQkJCXRyYWNlX3NtYjNfY3JlZGl0X3RpbWVvdXQo
c2VydmVyLT5DdXJyZW50TWlkLAotCQkJCQlzZXJ2ZXItPmhvc3RuYW1lLCBudW1fY3JlZGl0cywg
MCk7CisJCQkJCQlzZXJ2ZXItPmNvbm5faWQsIHNlcnZlci0+aG9zdG5hbWUsIHNjcmVkaXRzLCBu
dW1fY3JlZGl0cywgc2luX2ZsaWdodCk7CiAJCQkJY2lmc19zZXJ2ZXJfZGJnKFZGUywgIndhaXQg
dGltZWQgb3V0IGFmdGVyICVkIG1zXG4iLAotCQkJCQkgdGltZW91dCk7CisJCQkJCQl0aW1lb3V0
KTsKIAkJCQlyZXR1cm4gLUVCVVNZOwogCQkJfQogCQkJaWYgKHJjID09IC1FUkVTVEFSVFNZUykK
QEAgLTU5NSw2ICs2MTAsNyBAQCB3YWl0X2Zvcl9mcmVlX2NyZWRpdHMoc3RydWN0IFRDUF9TZXJ2
ZXJfSW5mbyAqc2VydmVyLCBjb25zdCBpbnQgbnVtX2NyZWRpdHMsCiAJCQkgICAgc2VydmVyLT5p
bl9mbGlnaHQgPiAyICogTUFYX0NPTVBPVU5EICYmCiAJCQkgICAgKmNyZWRpdHMgPD0gTUFYX0NP
TVBPVU5EKSB7CiAJCQkJc3Bpbl91bmxvY2soJnNlcnZlci0+cmVxX2xvY2spOworCiAJCQkJY2lm
c19udW1fd2FpdGVyc19pbmMoc2VydmVyKTsKIAkJCQlyYyA9IHdhaXRfZXZlbnRfa2lsbGFibGVf
dGltZW91dCgKIAkJCQkJc2VydmVyLT5yZXF1ZXN0X3EsCkBAIC02MDMsMTIgKzYxOSwxNyBAQCB3
YWl0X2Zvcl9mcmVlX2NyZWRpdHMoc3RydWN0IFRDUF9TZXJ2ZXJfSW5mbyAqc2VydmVyLCBjb25z
dCBpbnQgbnVtX2NyZWRpdHMsCiAJCQkJCXQpOwogCQkJCWNpZnNfbnVtX3dhaXRlcnNfZGVjKHNl
cnZlcik7CiAJCQkJaWYgKCFyYykgeworCQkJCQlzcGluX2xvY2soJnNlcnZlci0+cmVxX2xvY2sp
OworCQkJCQlzY3JlZGl0cyA9ICpjcmVkaXRzOworCQkJCQlzaW5fZmxpZ2h0ID0gc2VydmVyLT5p
bl9mbGlnaHQ7CisJCQkJCXNwaW5fdW5sb2NrKCZzZXJ2ZXItPnJlcV9sb2NrKTsKKwogCQkJCQl0
cmFjZV9zbWIzX2NyZWRpdF90aW1lb3V0KAotCQkJCQkJc2VydmVyLT5DdXJyZW50TWlkLAotCQkJ
CQkJc2VydmVyLT5ob3N0bmFtZSwgbnVtX2NyZWRpdHMsCi0JCQkJCQkwKTsKKwkJCQkJCQlzZXJ2
ZXItPkN1cnJlbnRNaWQsCisJCQkJCQkJc2VydmVyLT5jb25uX2lkLCBzZXJ2ZXItPmhvc3RuYW1l
LCAKKwkJCQkJCQlzY3JlZGl0cywgbnVtX2NyZWRpdHMsIHNpbl9mbGlnaHQpOwogCQkJCQljaWZz
X3NlcnZlcl9kYmcoVkZTLCAid2FpdCB0aW1lZCBvdXQgYWZ0ZXIgJWQgbXNcbiIsCi0JCQkJCQkg
dGltZW91dCk7CisJCQkJCQkJdGltZW91dCk7CiAJCQkJCXJldHVybiAtRUJVU1k7CiAJCQkJfQog
CQkJCWlmIChyYyA9PSAtRVJFU1RBUlRTWVMpCkBAIC02MjUsMTYgKzY0NiwxNyBAQCB3YWl0X2Zv
cl9mcmVlX2NyZWRpdHMoc3RydWN0IFRDUF9TZXJ2ZXJfSW5mbyAqc2VydmVyLCBjb25zdCBpbnQg
bnVtX2NyZWRpdHMsCiAJCQkvKiB1cGRhdGUgIyBvZiByZXF1ZXN0cyBvbiB0aGUgd2lyZSB0byBz
ZXJ2ZXIgKi8KIAkJCWlmICgoZmxhZ3MgJiBDSUZTX1RJTUVPVVRfTUFTSykgIT0gQ0lGU19CTE9D
S0lOR19PUCkgewogCQkJCSpjcmVkaXRzIC09IG51bV9jcmVkaXRzOwotCQkJCXNjcmVkaXRzID0g
KmNyZWRpdHM7CiAJCQkJc2VydmVyLT5pbl9mbGlnaHQgKz0gbnVtX2NyZWRpdHM7CiAJCQkJaWYg
KHNlcnZlci0+aW5fZmxpZ2h0ID4gc2VydmVyLT5tYXhfaW5fZmxpZ2h0KQogCQkJCQlzZXJ2ZXIt
Pm1heF9pbl9mbGlnaHQgPSBzZXJ2ZXItPmluX2ZsaWdodDsKIAkJCQkqaW5zdGFuY2UgPSBzZXJ2
ZXItPnJlY29ubmVjdF9pbnN0YW5jZTsKIAkJCX0KKwkJCXNjcmVkaXRzID0gKmNyZWRpdHM7CisJ
CQlzaW5fZmxpZ2h0ID0gc2VydmVyLT5pbl9mbGlnaHQ7CiAJCQlzcGluX3VubG9jaygmc2VydmVy
LT5yZXFfbG9jayk7CiAKIAkJCXRyYWNlX3NtYjNfYWRkX2NyZWRpdHMoc2VydmVyLT5DdXJyZW50
TWlkLAotCQkJCQlzZXJ2ZXItPmhvc3RuYW1lLCBzY3JlZGl0cywgLShudW1fY3JlZGl0cykpOwor
CQkJCQlzZXJ2ZXItPmNvbm5faWQsIHNlcnZlci0+aG9zdG5hbWUsIHNjcmVkaXRzLCAtKG51bV9j
cmVkaXRzKSwgc2luX2ZsaWdodCk7CiAJCQljaWZzX2RiZyhGWUksICIlczogcmVtb3ZlICV1IGNy
ZWRpdHMgdG90YWw9JWRcbiIsCiAJCQkJCV9fZnVuY19fLCBudW1fY3JlZGl0cywgc2NyZWRpdHMp
OwogCQkJYnJlYWs7CkBAIC02ODQsNyArNzA2LDcgQEAgd2FpdF9mb3JfY29tcG91bmRfcmVxdWVz
dChzdHJ1Y3QgVENQX1NlcnZlcl9JbmZvICpzZXJ2ZXIsIGludCBudW0sCiAJCWlmIChzZXJ2ZXIt
PmluX2ZsaWdodCA9PSAwKSB7CiAJCQlzcGluX3VubG9jaygmc2VydmVyLT5yZXFfbG9jayk7CiAJ
CQl0cmFjZV9zbWIzX2luc3VmZmljaWVudF9jcmVkaXRzKHNlcnZlci0+Q3VycmVudE1pZCwKLQkJ
CQkJc2VydmVyLT5ob3N0bmFtZSwgc2NyZWRpdHMsIHNpbl9mbGlnaHQpOworCQkJCQlzZXJ2ZXIt
PmNvbm5faWQsIHNlcnZlci0+aG9zdG5hbWUsIHNjcmVkaXRzLCBudW0sIHNpbl9mbGlnaHQpOwog
CQkJY2lmc19kYmcoRllJLCAiJXM6ICVkIHJlcXVlc3RzIGluIGZsaWdodCwgbmVlZGVkICVkIHRv
dGFsPSVkXG4iLAogCQkJCQlfX2Z1bmNfXywgc2luX2ZsaWdodCwgbnVtLCBzY3JlZGl0cyk7CiAJ
CQlyZXR1cm4gLUVERUFETEs7Ci0tIAoyLjI1LjEKCg==
--000000000000b01c3705ba7e39eb--
