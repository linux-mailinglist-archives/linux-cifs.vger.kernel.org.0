Return-Path: <linux-cifs-owner@vger.kernel.org>
X-Original-To: lists+linux-cifs@lfdr.de
Delivered-To: lists+linux-cifs@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 14CA236B6A0
	for <lists+linux-cifs@lfdr.de>; Mon, 26 Apr 2021 18:18:59 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S234387AbhDZQTi (ORCPT <rfc822;lists+linux-cifs@lfdr.de>);
        Mon, 26 Apr 2021 12:19:38 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:43166 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S234263AbhDZQTh (ORCPT
        <rfc822;linux-cifs@vger.kernel.org>); Mon, 26 Apr 2021 12:19:37 -0400
Received: from mail-yb1-xb31.google.com (mail-yb1-xb31.google.com [IPv6:2607:f8b0:4864:20::b31])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 0567CC061574
        for <linux-cifs@vger.kernel.org>; Mon, 26 Apr 2021 09:18:56 -0700 (PDT)
Received: by mail-yb1-xb31.google.com with SMTP id p126so11923638yba.1
        for <linux-cifs@vger.kernel.org>; Mon, 26 Apr 2021 09:18:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20161025;
        h=mime-version:from:date:message-id:subject:to;
        bh=YRfwBzZ2RTNzI7qGS36G3EhD0o9K2aLURuE/oPmMoiw=;
        b=I9wd1xtstEqoDiAhJNEro1OBRLdVFTpXlBnWKNL8m3GTpkqs/e/mRSbpkjR1Ni6kEV
         v8iKKV19+3E90qgT8LQPijbvdgu4rP5XXicC185NbXIxR/Ot6PdkDxnSwUR3lq0077bK
         vdaeW5WekhpnnR8yoBTmHlKTrf4907ofIO3ygNyNLggx61eQ/xVLnMcRXBvaar0PQP4p
         TuWNTrKMFm9CUF17hQpFrevSn/g435pzutHVOCXCilHXe+5HuXvlkxGbDhvVoHWC6qor
         O0g978Q7Wu3NSnTbFa8TsNQp4ktt4hz2vwR4IHRHq+EwaoDROnE5D0OOuc9PKD7bjRvY
         +m5g==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:mime-version:from:date:message-id:subject:to;
        bh=YRfwBzZ2RTNzI7qGS36G3EhD0o9K2aLURuE/oPmMoiw=;
        b=uQytQniIxOV9BEb/qiiDa1W4a+YHW+/XM2ruy1bLehEnY4Gk19lnGjrIloy89xvpwB
         nbxcbCCln8h+cTc1/hLa7UV7r44pniav0uyP8yP5r4fN2cuUiEQx2iLWsYakMP/zqbAa
         dz6GafjEOaffTMQ3J8PwCVEZssoK+fApDSomFEM+0XK+sDFRqEbjI4PYj3t36VtJSlqE
         Oz09QkbxKvyWWcpErd5XeeiSU/aff0rHu4XeeqWqwDfOFtGetIPVLdjL6gomPQfOycM0
         3toRboZIjpokdnkWH8yYbYOlJDHmJNFSRTQDDJE8Z+dmGu28Hq0L2VTCfgZhsAo7juFR
         Jbsw==
X-Gm-Message-State: AOAM533MtcMXfGQQtyOIwsFlzl/jzkAgVlfUdHyoGPQyyVyWUppn7OEk
        UJh6rxSCF7+X5ZeGpCSJXTGh4CQS9xC31zWtwPM=
X-Google-Smtp-Source: ABdhPJzKLIjsI8V2GHCxSYSYqxnOauCx/ygrLHjqIIe//4nJEspmo8jkvWeaJUuqfdfxCpC7/bhno8zePn9mRjcwBhI=
X-Received: by 2002:a05:6902:526:: with SMTP id y6mr16668552ybs.331.1619453935226;
 Mon, 26 Apr 2021 09:18:55 -0700 (PDT)
MIME-Version: 1.0
From:   Shyam Prasad N <nspmangalore@gmail.com>
Date:   Mon, 26 Apr 2021 21:48:44 +0530
Message-ID: <CANT5p=peB0L90CN1pVDe6uyrbz2=9jTm865N6938i5-ZJN42Bw@mail.gmail.com>
Subject: [PATCH] cifs: when out of credits on one channel, retry on another.
To:     =?UTF-8?Q?Aur=C3=A9lien_Aptel?= <aaptel@suse.com>,
        Steve French <smfrench@gmail.com>,
        CIFS <linux-cifs@vger.kernel.org>
Content-Type: multipart/mixed; boundary="0000000000008a2cf805c0e28022"
Precedence: bulk
List-ID: <linux-cifs.vger.kernel.org>
X-Mailing-List: linux-cifs@vger.kernel.org

--0000000000008a2cf805c0e28022
Content-Type: text/plain; charset="UTF-8"

Hi Aurelien/Steve,

Here is the multichannel out-of-credits related patch which we
discussed about a few weeks ago.
The idea is to retry on -EDEADLK (which we return when we run out of
credits and we have no requests in flight), so that another channel is
chosen for the next request.

-- 
Regards,
Shyam

--0000000000008a2cf805c0e28022
Content-Type: application/octet-stream; 
	name="0001-cifs-when-out-of-credits-on-one-channel-retry-on-ano.patch"
Content-Disposition: attachment; 
	filename="0001-cifs-when-out-of-credits-on-one-channel-retry-on-ano.patch"
Content-Transfer-Encoding: base64
Content-ID: <f_knysy3300>
X-Attachment-Id: f_knysy3300

RnJvbSBkOGUwZWNiMWFhMTk2YTJmZDg2YjZhNzhiNTJiNGE3YTkxYWMyMmM1IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBTaHlhbSBQcmFzYWQgTiA8c3ByYXNhZEBtaWNyb3NvZnQuY29t
PgpEYXRlOiBNb24sIDI2IEFwciAyMDIxIDEyOjI4OjUwICswMDAwClN1YmplY3Q6IFtQQVRDSF0g
Y2lmczogd2hlbiBvdXQgb2YgY3JlZGl0cyBvbiBvbmUgY2hhbm5lbCwgcmV0cnkgb24gYW5vdGhl
ci4KCkZvbGxvd2luZyB0aGUgZml4OgpzbWIzOiBmaXggY3JlZGl0aW5nIGZvciBjb21wb3VuZGlu
ZyB3aGVuIG9ubHkgb25lIHJlcXVlc3QgaW4gZmxpZ2h0CgouLi4gd2UncmUgcmV0dXJuaW5nIC1F
REVBRExLIHdoZW4gd2UgcnVuIG91dCBvZiBjcmVkaXRzIG9uIGEKY29ubmVjdGlvbiB0byB0aGUg
c2VydmVyLCBpbmRpY2F0aW5nIGEgd3JvbmcgYWNjb3VudGluZy4KCkhvd2V2ZXIsIGZvciBhIG11
bHRpY2hhbm5lbCBzY2VuYXJpbywgd2Ugc2hvdWxkIG5vdCByZXR1cm4gdGhpcyBlcnJvcgpzdHJh
aWdodGF3YXksIGFzIHRoZXJlIGNvdWxkIGJlIG90aGVyIGNoYW5uZWxzIHRoYXQgZG8gaGF2ZSBj
cmVkaXRzLgpXZSBtdXN0IHRyeSBhbGwgY2hhbm5lbHMgYmVmb3JlIHdlIGdpdmUgdXAuCgpUb2Rh
eSwgd2UgZG9uJ3QgaGF2ZSBhIGdvb2Qgd2F5IHRvIGtub3cgd2hlbiB0byBnaXZlIHVwIGhlcmUu
ClNvIHdlIGtlZXAgcmV0cnlpbmcgaW5kZWZpbml0ZWx5LiBBbHNvLCB0aGlzIGZpeCBhc3N1bWVz
IHRoYXQKY2lmc19waWNrX2NoYW5uZWwoKSBzZWxlY3RzIGEgZGlmZmVyZW50IGNoYW5uZWwgb24g
cmV0cnkuCldoZW4gYSBuZXcgY2hhbm5lbCBhbGxvY2F0aW9uIHN0cmF0ZWd5IGlzIGltcGxlbWVu
dGVkLCB3ZSBzaG91bGQKbWFrZSBzdXJlIHRoYXQgd2UgZG9uJ3Qgc2VsZWN0IGEgY2hhbm5lbCB0
aGF0IHJhbiBvdXQgb2YgY3JlZGl0cywKdW5sZXNzIGl0IHJlY2VpdmVkIGNyZWRpdHMgZnJvbSB0
aGUgc2VydmVyLgoKVGhpcyBmaXggbW9zdGx5IGludHJvZHVjZXMgYSB3cmFwcGVyIGZvciBhbGwg
ZnVuY3Rpb25zIHdoaWNoIGNhbGwKY2lmc19waWNrX2NoYW5uZWwuIEluIHRoZSB3cmFwcGVyIGZ1
bmN0aW9uLCB0aGUgZnVuY3Rpb24gaXMgcmV0cmllZAp3aGVuIHRoZSBlcnJvciBpcyAtRURFQURM
SywgYW5kIHVzZXMgbXVsdGljaGFubmVsLgoKU2lnbmVkLW9mZi1ieTogU2h5YW0gUHJhc2FkIE4g
PHNwcmFzYWRAbWljcm9zb2Z0LmNvbT4KLS0tCiBmcy9jaWZzL2ZpbGUuYyAgICAgIHwgIDk2ICsr
KysrKysrKysrLQogZnMvY2lmcy9zbWIyaW5vZGUuYyB8ICA5MyArKysrKysrKy0tLS0KIGZzL2Np
ZnMvc21iMm9wcy5jICAgfCAxMTMgKysrKysrKysrKysrKy0KIGZzL2NpZnMvc21iMnBkdS5jICAg
fCAzNTkgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0KIDQgZmls
ZXMgY2hhbmdlZCwgNTkzIGluc2VydGlvbnMoKyksIDY4IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdp
dCBhL2ZzL2NpZnMvZmlsZS5jIGIvZnMvY2lmcy9maWxlLmMKaW5kZXggN2U5N2FlYWJkNjE2Li43
NjA5Yjk3MzljZTQgMTAwNjQ0Ci0tLSBhL2ZzL2NpZnMvZmlsZS5jCisrKyBiL2ZzL2NpZnMvZmls
ZS5jCkBAIC0yMzc4LDcgKzIzNzgsNyBAQCB3ZGF0YV9zZW5kX3BhZ2VzKHN0cnVjdCBjaWZzX3dy
aXRlZGF0YSAqd2RhdGEsIHVuc2lnbmVkIGludCBucl9wYWdlcywKIAlyZXR1cm4gcmM7CiB9CiAK
LXN0YXRpYyBpbnQgY2lmc193cml0ZXBhZ2VzKHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5n
LAorc3RhdGljIGludCBjaWZzX3dyaXRlcGFnZXNfZmluYWwoc3RydWN0IGFkZHJlc3Nfc3BhY2Ug
Km1hcHBpbmcsCiAJCQkgICBzdHJ1Y3Qgd3JpdGViYWNrX2NvbnRyb2wgKndiYykKIHsKIAlzdHJ1
Y3QgaW5vZGUgKmlub2RlID0gbWFwcGluZy0+aG9zdDsKQEAgLTI1NDMsNiArMjU0MywyMSBAQCBz
dGF0aWMgaW50IGNpZnNfd3JpdGVwYWdlcyhzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywK
IAlyZXR1cm4gcmM7CiB9CiAKK3N0YXRpYyBpbnQgY2lmc193cml0ZXBhZ2VzKHN0cnVjdCBhZGRy
ZXNzX3NwYWNlICptYXBwaW5nLAorCQkJICAgc3RydWN0IHdyaXRlYmFja19jb250cm9sICp3YmMp
Cit7CisJaW50IHJjOworCXN0cnVjdCBpbm9kZSAqaW5vZGUgPSBtYXBwaW5nLT5ob3N0OworCXN0
cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IgPSBDSUZTX1NCKGlub2RlLT5pX3NiKTsKKwlzdHJ1
Y3QgY2lmc190Y29uICp0Y29uID0gY2lmc19zYl9tYXN0ZXJfdGNvbihjaWZzX3NiKTsKKworCWRv
IHsKKwkJcmMgPSBjaWZzX3dyaXRlcGFnZXNfZmluYWwobWFwcGluZywgd2JjKTsgCisJfSB3aGls
ZSAodGNvbi0+c2VzLT5jaGFuX2NvdW50ID4gMSAmJiByYyA9PSAtRURFQURMSyk7CisKKwlyZXR1
cm4gcmM7Cit9CisKIHN0YXRpYyBpbnQKIGNpZnNfd3JpdGVwYWdlX2xvY2tlZChzdHJ1Y3QgcGFn
ZSAqcGFnZSwgc3RydWN0IHdyaXRlYmFja19jb250cm9sICp3YmMpCiB7CkBAIC0yOTM3LDcgKzI5
NTIsNyBAQCBjaWZzX3Jlc2VuZF93ZGF0YShzdHJ1Y3QgY2lmc193cml0ZWRhdGEgKndkYXRhLCBz
dHJ1Y3QgbGlzdF9oZWFkICp3ZGF0YV9saXN0LAogfQogCiBzdGF0aWMgaW50Ci1jaWZzX3dyaXRl
X2Zyb21faXRlcihsb2ZmX3Qgb2Zmc2V0LCBzaXplX3QgbGVuLCBzdHJ1Y3QgaW92X2l0ZXIgKmZy
b20sCitjaWZzX3dyaXRlX2Zyb21faXRlcl9maW5hbChsb2ZmX3Qgb2Zmc2V0LCBzaXplX3QgbGVu
LCBzdHJ1Y3QgaW92X2l0ZXIgKmZyb20sCiAJCSAgICAgc3RydWN0IGNpZnNGaWxlSW5mbyAqb3Bl
bl9maWxlLAogCQkgICAgIHN0cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IsIHN0cnVjdCBsaXN0
X2hlYWQgKndkYXRhX2xpc3QsCiAJCSAgICAgc3RydWN0IGNpZnNfYWlvX2N0eCAqY3R4KQpAQCAt
MzEwMiw2ICszMTE3LDI0IEBAIGNpZnNfd3JpdGVfZnJvbV9pdGVyKGxvZmZfdCBvZmZzZXQsIHNp
emVfdCBsZW4sIHN0cnVjdCBpb3ZfaXRlciAqZnJvbSwKIAlyZXR1cm4gcmM7CiB9CiAKK3N0YXRp
YyBpbnQKK2NpZnNfd3JpdGVfZnJvbV9pdGVyKGxvZmZfdCBvZmZzZXQsIHNpemVfdCBsZW4sIHN0
cnVjdCBpb3ZfaXRlciAqZnJvbSwKKwkJICAgICBzdHJ1Y3QgY2lmc0ZpbGVJbmZvICpvcGVuX2Zp
bGUsCisJCSAgICAgc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYiwgc3RydWN0IGxpc3RfaGVh
ZCAqd2RhdGFfbGlzdCwKKwkJICAgICBzdHJ1Y3QgY2lmc19haW9fY3R4ICpjdHgpCit7CisJaW50
IHJjOworCXN0cnVjdCBjaWZzX3Rjb24gKnRjb24gPSB0bGlua190Y29uKG9wZW5fZmlsZS0+dGxp
bmspOworCisJZG8geworCQlyYyA9IGNpZnNfd3JpdGVfZnJvbV9pdGVyX2ZpbmFsKG9mZnNldCwg
bGVuLCBmcm9tLAorCQkJCW9wZW5fZmlsZSwgY2lmc19zYiwKKwkJCQl3ZGF0YV9saXN0LCBjdHgp
OyAKKwl9IHdoaWxlICh0Y29uLT5zZXMtPmNoYW5fY291bnQgPiAxICYmIHJjID09IC1FREVBRExL
KTsKKworCXJldHVybiByYzsKK30KKwogc3RhdGljIHZvaWQgY29sbGVjdF91bmNhY2hlZF93cml0
ZV9kYXRhKHN0cnVjdCBjaWZzX2Fpb19jdHggKmN0eCkKIHsKIAlzdHJ1Y3QgY2lmc193cml0ZWRh
dGEgKndkYXRhLCAqdG1wOwpAQCAtMzY3MSw3ICszNzA0LDcgQEAgc3RhdGljIGludCBjaWZzX3Jl
c2VuZF9yZGF0YShzdHJ1Y3QgY2lmc19yZWFkZGF0YSAqcmRhdGEsCiB9CiAKIHN0YXRpYyBpbnQK
LWNpZnNfc2VuZF9hc3luY19yZWFkKGxvZmZfdCBvZmZzZXQsIHNpemVfdCBsZW4sIHN0cnVjdCBj
aWZzRmlsZUluZm8gKm9wZW5fZmlsZSwKK2NpZnNfc2VuZF9hc3luY19yZWFkX2ZpbmFsKGxvZmZf
dCBvZmZzZXQsIHNpemVfdCBsZW4sIHN0cnVjdCBjaWZzRmlsZUluZm8gKm9wZW5fZmlsZSwKIAkJ
ICAgICBzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiLCBzdHJ1Y3QgbGlzdF9oZWFkICpyZGF0
YV9saXN0LAogCQkgICAgIHN0cnVjdCBjaWZzX2Fpb19jdHggKmN0eCkKIHsKQEAgLTM4MTIsNiAr
Mzg0NSwyMyBAQCBjaWZzX3NlbmRfYXN5bmNfcmVhZChsb2ZmX3Qgb2Zmc2V0LCBzaXplX3QgbGVu
LCBzdHJ1Y3QgY2lmc0ZpbGVJbmZvICpvcGVuX2ZpbGUsCiAJcmV0dXJuIHJjOwogfQogCitzdGF0
aWMgaW50CitjaWZzX3NlbmRfYXN5bmNfcmVhZChsb2ZmX3Qgb2Zmc2V0LCBzaXplX3QgbGVuLCBz
dHJ1Y3QgY2lmc0ZpbGVJbmZvICpvcGVuX2ZpbGUsCisJCSAgICAgc3RydWN0IGNpZnNfc2JfaW5m
byAqY2lmc19zYiwgc3RydWN0IGxpc3RfaGVhZCAqcmRhdGFfbGlzdCwKKwkJICAgICBzdHJ1Y3Qg
Y2lmc19haW9fY3R4ICpjdHgpCit7CisJaW50IHJjOworCXN0cnVjdCBjaWZzX3Rjb24gKnRjb24g
PSB0bGlua190Y29uKG9wZW5fZmlsZS0+dGxpbmspOworCisJZG8geworCQlyYyA9IGNpZnNfc2Vu
ZF9hc3luY19yZWFkX2ZpbmFsKG9mZnNldCwgbGVuLAorCQkJCW9wZW5fZmlsZSwgY2lmc19zYiwK
KwkJCQlyZGF0YV9saXN0LCBjdHgpOyAKKwl9IHdoaWxlICh0Y29uLT5zZXMtPmNoYW5fY291bnQg
PiAxICYmIHJjID09IC1FREVBRExLKTsKKworCXJldHVybiByYzsKK30KKwogc3RhdGljIHZvaWQK
IGNvbGxlY3RfdW5jYWNoZWRfcmVhZF9kYXRhKHN0cnVjdCBjaWZzX2Fpb19jdHggKmN0eCkKIHsK
QEAgLTQwNzEsNyArNDEyMSw3IEBAIGNpZnNfc3RyaWN0X3JlYWR2KHN0cnVjdCBraW9jYiAqaW9j
Yiwgc3RydWN0IGlvdl9pdGVyICp0bykKIH0KIAogc3RhdGljIHNzaXplX3QKLWNpZnNfcmVhZChz
dHJ1Y3QgZmlsZSAqZmlsZSwgY2hhciAqcmVhZF9kYXRhLCBzaXplX3QgcmVhZF9zaXplLCBsb2Zm
X3QgKm9mZnNldCkKK2NpZnNfcmVhZF9maW5hbChzdHJ1Y3QgZmlsZSAqZmlsZSwgY2hhciAqcmVh
ZF9kYXRhLCBzaXplX3QgcmVhZF9zaXplLCBsb2ZmX3QgKm9mZnNldCkKIHsKIAlpbnQgcmMgPSAt
RUFDQ0VTOwogCXVuc2lnbmVkIGludCBieXRlc19yZWFkID0gMDsKQEAgLTQxNjIsNiArNDIxMiwy
NCBAQCBjaWZzX3JlYWQoc3RydWN0IGZpbGUgKmZpbGUsIGNoYXIgKnJlYWRfZGF0YSwgc2l6ZV90
IHJlYWRfc2l6ZSwgbG9mZl90ICpvZmZzZXQpCiAJcmV0dXJuIHRvdGFsX3JlYWQ7CiB9CiAKK3N0
YXRpYyBzc2l6ZV90CitjaWZzX3JlYWQoc3RydWN0IGZpbGUgKmZpbGUsIGNoYXIgKnJlYWRfZGF0
YSwgc2l6ZV90IHJlYWRfc2l6ZSwgbG9mZl90ICpvZmZzZXQpCit7CisJaW50IHJjOworCXN0cnVj
dCBjaWZzRmlsZUluZm8gKm9wZW5fZmlsZTsKKwlzdHJ1Y3QgY2lmc190Y29uICp0Y29uOworCisJ
b3Blbl9maWxlID0gZmlsZS0+cHJpdmF0ZV9kYXRhOworCXRjb24gPSB0bGlua190Y29uKG9wZW5f
ZmlsZS0+dGxpbmspOworCisJZG8geworCQlyYyA9IGNpZnNfcmVhZF9maW5hbChmaWxlLCByZWFk
X2RhdGEsCisJCQkJcmVhZF9zaXplLCBvZmZzZXQpOyAKKwl9IHdoaWxlICh0Y29uLT5zZXMtPmNo
YW5fY291bnQgPiAxICYmIHJjID09IC1FREVBRExLKTsKKworCXJldHVybiByYzsKK30KKwogLyoK
ICAqIElmIHRoZSBwYWdlIGlzIG1tYXAnZWQgaW50byBhIHByb2Nlc3MnIHBhZ2UgdGFibGVzLCB0
aGVuIHdlIG5lZWQgdG8gbWFrZQogICogc3VyZSB0aGF0IGl0IGRvZXNuJ3QgY2hhbmdlIHdoaWxl
IGJlaW5nIHdyaXR0ZW4gYmFjay4KQEAgLTQ0MTIsNyArNDQ4MCw3IEBAIHJlYWRwYWdlc19nZXRf
cGFnZXMoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsIHN0cnVjdCBsaXN0X2hlYWQgKnBh
Z2VfbGlzdCwKIAlyZXR1cm4gcmM7CiB9CiAKLXN0YXRpYyBpbnQgY2lmc19yZWFkcGFnZXMoc3Ry
dWN0IGZpbGUgKmZpbGUsIHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nLAorc3RhdGljIGlu
dCBjaWZzX3JlYWRwYWdlc19maW5hbChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IGFkZHJlc3Nf
c3BhY2UgKm1hcHBpbmcsCiAJc3RydWN0IGxpc3RfaGVhZCAqcGFnZV9saXN0LCB1bnNpZ25lZCBu
dW1fcGFnZXMpCiB7CiAJaW50IHJjOwpAQCAtNDU2Nyw2ICs0NjM1LDI0IEBAIHN0YXRpYyBpbnQg
Y2lmc19yZWFkcGFnZXMoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCBhZGRyZXNzX3NwYWNlICpt
YXBwaW5nLAogCXJldHVybiByYzsKIH0KIAorc3RhdGljIGludCBjaWZzX3JlYWRwYWdlcyhzdHJ1
Y3QgZmlsZSAqZmlsZSwgc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCisJc3RydWN0IGxp
c3RfaGVhZCAqcGFnZV9saXN0LCB1bnNpZ25lZCBudW1fcGFnZXMpCit7CisJaW50IHJjOworCXN0
cnVjdCBjaWZzRmlsZUluZm8gKm9wZW5fZmlsZTsKKwlzdHJ1Y3QgY2lmc190Y29uICp0Y29uOwor
CisJb3Blbl9maWxlID0gZmlsZS0+cHJpdmF0ZV9kYXRhOworCXRjb24gPSB0bGlua190Y29uKG9w
ZW5fZmlsZS0+dGxpbmspOworCisJZG8geworCQlyYyA9IGNpZnNfcmVhZHBhZ2VzX2ZpbmFsKGZp
bGUsIG1hcHBpbmcsCisJCQkJcGFnZV9saXN0LCBudW1fcGFnZXMpOyAKKwl9IHdoaWxlICh0Y29u
LT5zZXMtPmNoYW5fY291bnQgPiAxICYmIHJjID09IC1FREVBRExLKTsKKworCXJldHVybiByYzsK
K30KKwogLyoKICAqIGNpZnNfcmVhZHBhZ2Vfd29ya2VyIG11c3QgYmUgY2FsbGVkIHdpdGggdGhl
IHBhZ2UgcGlubmVkCiAgKi8KZGlmZiAtLWdpdCBhL2ZzL2NpZnMvc21iMmlub2RlLmMgYi9mcy9j
aWZzL3NtYjJpbm9kZS5jCmluZGV4IDlhNjEyMDlhMjgzZS4uMjRjMDJhOTg5ZDFkIDEwMDY0NAot
LS0gYS9mcy9jaWZzL3NtYjJpbm9kZS5jCisrKyBiL2ZzL2NpZnMvc21iMmlub2RlLmMKQEAgLTYw
LDcgKzYwLDcgQEAgc3RydWN0IGNvcF92YXJzIHsKIH07CiAKIHN0YXRpYyBpbnQKLXNtYjJfY29t
cG91bmRfb3AoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwK
K3NtYjJfY29tcG91bmRfb3BfZmluYWwoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNp
ZnNfdGNvbiAqdGNvbiwKIAkJIHN0cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IsIGNvbnN0IGNo
YXIgKmZ1bGxfcGF0aCwKIAkJIF9fdTMyIGRlc2lyZWRfYWNjZXNzLCBfX3UzMiBjcmVhdGVfZGlz
cG9zaXRpb24sCiAJCSBfX3UzMiBjcmVhdGVfb3B0aW9ucywgdW1vZGVfdCBtb2RlLCB2b2lkICpw
dHIsIGludCBjb21tYW5kLApAQCAtMzcxLDggKzM3MSw2IEBAIHNtYjJfY29tcG91bmRfb3AoY29u
c3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAludW1fcnFzdCsr
OwogCiAJaWYgKGNmaWxlKSB7Ci0JCWNpZnNGaWxlSW5mb19wdXQoY2ZpbGUpOwotCQljZmlsZSA9
IE5VTEw7CiAJCXJjID0gY29tcG91bmRfc2VuZF9yZWN2KHhpZCwgc2VzLCBzZXJ2ZXIsCiAJCQkJ
CWZsYWdzLCBudW1fcnFzdCAtIDIsCiAJCQkJCSZycXN0WzFdLCAmcmVzcF9idWZ0eXBlWzFdLApA
QCAtMzg0LDkgKzM4Miw2IEBAIHNtYjJfY29tcG91bmRfb3AoY29uc3QgdW5zaWduZWQgaW50IHhp
ZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJCQkJcnNwX2lvdik7CiAKICBmaW5pc2hlZDoK
LQlpZiAoY2ZpbGUpCi0JCWNpZnNGaWxlSW5mb19wdXQoY2ZpbGUpOwotCiAJU01CMl9vcGVuX2Zy
ZWUoJnJxc3RbMF0pOwogCWlmIChyYyA9PSAtRVJFTUNIRykgewogCQlwcl93YXJuX29uY2UoInNl
cnZlciBzaGFyZSAlcyBkZWxldGVkXG4iLCB0Y29uLT50cmVlTmFtZSk7CkBAIC00OTQsNiArNDg5
LDQzIEBAIHNtYjJfY29tcG91bmRfb3AoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNp
ZnNfdGNvbiAqdGNvbiwKIAlyZXR1cm4gcmM7CiB9CiAKK3N0YXRpYyBpbnQKK3NtYjJfY29tcG91
bmRfb3AoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKKwkJ
IHN0cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IsIGNvbnN0IGNoYXIgKmZ1bGxfcGF0aCwKKwkJ
IF9fdTMyIGRlc2lyZWRfYWNjZXNzLCBfX3UzMiBjcmVhdGVfZGlzcG9zaXRpb24sCisJCSBfX3Uz
MiBjcmVhdGVfb3B0aW9ucywgdW1vZGVfdCBtb2RlLCB2b2lkICpwdHIsIGludCBjb21tYW5kLAor
CQkgYm9vbCBjaGVja19vcGVuLCBib29sIHdyaXRhYmxlX3BhdGgpCit7CisJaW50IGZsYWdzOwor
CWludCByYzsKKwlzdHJ1Y3QgY2lmc0ZpbGVJbmZvICpjZmlsZTsKKworCS8qIENoZWNrIGlmIHdl
IGhhdmUgdGhlIGhhbmRsZSBvcGVuICovCisJaWYgKGNoZWNrX29wZW4pIHsKKwkJaWYgKHdyaXRh
YmxlX3BhdGgpIHsKKwkJCWlmIChjb21tYW5kID09IFNNQjJfT1BfUkVOQU1FKQorCQkJCWZsYWdz
ID0gRklORF9XUl9XSVRIX0RFTEVURTsKKwkJCWVsc2UKKwkJCQlmbGFncyA9IEZJTkRfV1JfQU5Z
OworCisJCQljaWZzX2dldF93cml0YWJsZV9wYXRoKHRjb24sIGZ1bGxfcGF0aCwgZmxhZ3MsICZj
ZmlsZSk7CisJCX0gZWxzZQorCQkJY2lmc19nZXRfcmVhZGFibGVfcGF0aCh0Y29uLCBmdWxsX3Bh
dGgsICZjZmlsZSk7CisJfQorCQorCS8qIElmIHdlIHJhbiBvdXQgb2YgY3JlZGl0cywgYW5kIHNl
cyB1c2VzIG11bHRpY2hhbm5lbCwgdHJ5IGFnYWluIG9uIGFub3RoZXIgY2hhbiAqLworCWRvIHsK
KwkJcmMgPSBzbWIyX2NvbXBvdW5kX29wX2ZpbmFsKHhpZCwgdGNvbiwgY2lmc19zYiwgZnVsbF9w
YXRoLAorCQkJCWRlc2lyZWRfYWNjZXNzLCBjcmVhdGVfZGlzcG9zaXRpb24sIGNyZWF0ZV9vcHRp
b25zLAorCQkJCW1vZGUsIHB0ciwgY29tbWFuZCwgY2ZpbGUpOworCX0gd2hpbGUgKHRjb24tPnNl
cy0+Y2hhbl9jb3VudCA+IDEgJiYgcmMgPT0gLUVERUFETEspOworCisJaWYgKGNoZWNrX29wZW4g
JiYgY2ZpbGUpCisJCWNpZnNGaWxlSW5mb19wdXQoY2ZpbGUpOworCQorCXJldHVybiByYzsKK30K
Kwogdm9pZAogbW92ZV9zbWIyX2luZm9fdG9fY2lmcyhGSUxFX0FMTF9JTkZPICpkc3QsIHN0cnVj
dCBzbWIyX2ZpbGVfYWxsX2luZm8gKnNyYykKIHsKQEAgLTUxMiw3ICs1NDQsNiBAQCBzbWIyX3F1
ZXJ5X3BhdGhfaW5mbyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0
Y29uLAogCWludCByYzsKIAlzdHJ1Y3Qgc21iMl9maWxlX2FsbF9pbmZvICpzbWIyX2RhdGE7CiAJ
X191MzIgY3JlYXRlX29wdGlvbnMgPSAwOwotCXN0cnVjdCBjaWZzRmlsZUluZm8gKmNmaWxlOwog
CXN0cnVjdCBjYWNoZWRfZmlkICpjZmlkID0gTlVMTDsKIAogCSphZGp1c3RfdHogPSBmYWxzZTsK
QEAgLTU0MCwxMCArNTcxLDExIEBAIHNtYjJfcXVlcnlfcGF0aF9pbmZvKGNvbnN0IHVuc2lnbmVk
IGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCiAJCWdvdG8gb3V0OwogCX0KIAotCWNp
ZnNfZ2V0X3JlYWRhYmxlX3BhdGgodGNvbiwgZnVsbF9wYXRoLCAmY2ZpbGUpOwogCXJjID0gc21i
Ml9jb21wb3VuZF9vcCh4aWQsIHRjb24sIGNpZnNfc2IsIGZ1bGxfcGF0aCwKIAkJCSAgICAgIEZJ
TEVfUkVBRF9BVFRSSUJVVEVTLCBGSUxFX09QRU4sIGNyZWF0ZV9vcHRpb25zLAotCQkJICAgICAg
QUNMX05PX01PREUsIHNtYjJfZGF0YSwgU01CMl9PUF9RVUVSWV9JTkZPLCBjZmlsZSk7CisJCQkg
ICAgICBBQ0xfTk9fTU9ERSwgc21iMl9kYXRhLCBTTUIyX09QX1FVRVJZX0lORk8sIAorCQkJCSAg
dHJ1ZSwgZmFsc2UpOworCiAJaWYgKHJjID09IC1FT1BOT1RTVVBQKSB7CiAJCSpyZXBhcnNlID0g
dHJ1ZTsKIAkJY3JlYXRlX29wdGlvbnMgfD0gT1BFTl9SRVBBUlNFX1BPSU5UOwpAQCAtNTUyLDcg
KzU4NCw4IEBAIHNtYjJfcXVlcnlfcGF0aF9pbmZvKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0
cnVjdCBjaWZzX3Rjb24gKnRjb24sCiAJCXJjID0gc21iMl9jb21wb3VuZF9vcCh4aWQsIHRjb24s
IGNpZnNfc2IsIGZ1bGxfcGF0aCwKIAkJCQkgICAgICBGSUxFX1JFQURfQVRUUklCVVRFUywgRklM
RV9PUEVOLAogCQkJCSAgICAgIGNyZWF0ZV9vcHRpb25zLCBBQ0xfTk9fTU9ERSwKLQkJCQkgICAg
ICBzbWIyX2RhdGEsIFNNQjJfT1BfUVVFUllfSU5GTywgTlVMTCk7CisJCQkJICAgICAgc21iMl9k
YXRhLCBTTUIyX09QX1FVRVJZX0lORk8sIAorCQkJCQkgIGZhbHNlLCBmYWxzZSk7CiAJfQogCWlm
IChyYykKIAkJZ290byBvdXQ7CkBAIC01NzEsNyArNjA0LDYgQEAgc21iMzExX3Bvc2l4X3F1ZXJ5
X3BhdGhfaW5mbyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29u
LAogewogCWludCByYzsKIAlfX3UzMiBjcmVhdGVfb3B0aW9ucyA9IDA7Ci0Jc3RydWN0IGNpZnNG
aWxlSW5mbyAqY2ZpbGU7CiAJc3RydWN0IHNtYjMxMV9wb3NpeF9xaW5mbyAqc21iMl9kYXRhOwog
CiAJKmFkanVzdF90eiA9IGZhbHNlOwpAQCAtNTkwLDEwICs2MjIsMTAgQEAgc21iMzExX3Bvc2l4
X3F1ZXJ5X3BhdGhfaW5mbyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29u
ICp0Y29uLAogCSAqIChhbHdheXMgdXNpbmcgdGhlIGNvbXBvdW5kZWQgdmVyc2lvbikuCiAJICov
CiAKLQljaWZzX2dldF9yZWFkYWJsZV9wYXRoKHRjb24sIGZ1bGxfcGF0aCwgJmNmaWxlKTsKIAly
YyA9IHNtYjJfY29tcG91bmRfb3AoeGlkLCB0Y29uLCBjaWZzX3NiLCBmdWxsX3BhdGgsCiAJCQkg
ICAgICBGSUxFX1JFQURfQVRUUklCVVRFUywgRklMRV9PUEVOLCBjcmVhdGVfb3B0aW9ucywKLQkJ
CSAgICAgIEFDTF9OT19NT0RFLCBzbWIyX2RhdGEsIFNNQjJfT1BfUE9TSVhfUVVFUllfSU5GTywg
Y2ZpbGUpOworCQkJICAgICAgQUNMX05PX01PREUsIHNtYjJfZGF0YSwgU01CMl9PUF9QT1NJWF9R
VUVSWV9JTkZPLAorCQkJCSAgdHJ1ZSwgZmFsc2UpOwogCWlmIChyYyA9PSAtRU9QTk9UU1VQUCkg
ewogCQkvKiBCQiBUT0RPOiBXaGVuIHN1cHBvcnQgZm9yIHNwZWNpYWwgZmlsZXMgYWRkZWQgdG8g
U2FtYmEgcmUtdmVyaWZ5IHRoaXMgcGF0aCAqLwogCQkqcmVwYXJzZSA9IHRydWU7CkBAIC02MDMs
NyArNjM1LDggQEAgc21iMzExX3Bvc2l4X3F1ZXJ5X3BhdGhfaW5mbyhjb25zdCB1bnNpZ25lZCBp
bnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCQlyYyA9IHNtYjJfY29tcG91bmRfb3Ao
eGlkLCB0Y29uLCBjaWZzX3NiLCBmdWxsX3BhdGgsCiAJCQkJICAgICAgRklMRV9SRUFEX0FUVFJJ
QlVURVMsIEZJTEVfT1BFTiwKIAkJCQkgICAgICBjcmVhdGVfb3B0aW9ucywgQUNMX05PX01PREUs
Ci0JCQkJICAgICAgc21iMl9kYXRhLCBTTUIyX09QX1BPU0lYX1FVRVJZX0lORk8sIE5VTEwpOwor
CQkJCSAgICAgIHNtYjJfZGF0YSwgU01CMl9PUF9QT1NJWF9RVUVSWV9JTkZPLAorCQkJCQkgIGZh
bHNlLCBmYWxzZSk7CiAJfQogCWlmIChyYykKIAkJZ290byBvdXQ7CkBAIC02MjQsNyArNjU3LDcg
QEAgc21iMl9ta2Rpcihjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgaW5vZGUgKnBhcmVu
dF9pbm9kZSwgdW1vZGVfdCBtb2RlLAogCXJldHVybiBzbWIyX2NvbXBvdW5kX29wKHhpZCwgdGNv
biwgY2lmc19zYiwgbmFtZSwKIAkJCQlGSUxFX1dSSVRFX0FUVFJJQlVURVMsIEZJTEVfQ1JFQVRF
LAogCQkJCUNSRUFURV9OT1RfRklMRSwgbW9kZSwgTlVMTCwgU01CMl9PUF9NS0RJUiwKLQkJCQlO
VUxMKTsKKwkJCQlmYWxzZSwgZmFsc2UpOwogfQogCiB2b2lkCkBAIC02MzQsNyArNjY3LDYgQEAg
c21iMl9ta2Rpcl9zZXRpbmZvKHN0cnVjdCBpbm9kZSAqaW5vZGUsIGNvbnN0IGNoYXIgKm5hbWUs
CiB7CiAJRklMRV9CQVNJQ19JTkZPIGRhdGE7CiAJc3RydWN0IGNpZnNJbm9kZUluZm8gKmNpZnNf
aTsKLQlzdHJ1Y3QgY2lmc0ZpbGVJbmZvICpjZmlsZTsKIAl1MzIgZG9zYXR0cnM7CiAJaW50IHRt
cHJjOwogCkBAIC02NDIsMTEgKzY3NCwxMSBAQCBzbWIyX21rZGlyX3NldGluZm8oc3RydWN0IGlu
b2RlICppbm9kZSwgY29uc3QgY2hhciAqbmFtZSwKIAljaWZzX2kgPSBDSUZTX0koaW5vZGUpOwog
CWRvc2F0dHJzID0gY2lmc19pLT5jaWZzQXR0cnMgfCBBVFRSX1JFQURPTkxZOwogCWRhdGEuQXR0
cmlidXRlcyA9IGNwdV90b19sZTMyKGRvc2F0dHJzKTsKLQljaWZzX2dldF93cml0YWJsZV9wYXRo
KHRjb24sIG5hbWUsIEZJTkRfV1JfQU5ZLCAmY2ZpbGUpOwogCXRtcHJjID0gc21iMl9jb21wb3Vu
ZF9vcCh4aWQsIHRjb24sIGNpZnNfc2IsIG5hbWUsCiAJCQkJIEZJTEVfV1JJVEVfQVRUUklCVVRF
UywgRklMRV9DUkVBVEUsCiAJCQkJIENSRUFURV9OT1RfRklMRSwgQUNMX05PX01PREUsCi0JCQkJ
ICZkYXRhLCBTTUIyX09QX1NFVF9JTkZPLCBjZmlsZSk7CisJCQkJICZkYXRhLCBTTUIyX09QX1NF
VF9JTkZPLAorCQkJCSB0cnVlLCB0cnVlKTsKIAlpZiAodG1wcmMgPT0gMCkKIAkJY2lmc19pLT5j
aWZzQXR0cnMgPSBkb3NhdHRyczsKIH0KQEAgLTY1Nyw3ICs2ODksOCBAQCBzbWIyX3JtZGlyKGNv
bnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sIGNvbnN0IGNoYXIg
Km5hbWUsCiB7CiAJcmV0dXJuIHNtYjJfY29tcG91bmRfb3AoeGlkLCB0Y29uLCBjaWZzX3NiLCBu
YW1lLCBERUxFVEUsIEZJTEVfT1BFTiwKIAkJCQlDUkVBVEVfTk9UX0ZJTEUsIEFDTF9OT19NT0RF
LAotCQkJCU5VTEwsIFNNQjJfT1BfUk1ESVIsIE5VTEwpOworCQkJCU5VTEwsIFNNQjJfT1BfUk1E
SVIsCisJCQkJZmFsc2UsIGZhbHNlKTsKIH0KIAogaW50CkBAIC02NjYsMTQgKzY5OSwxNSBAQCBz
bWIyX3VubGluayhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29u
LCBjb25zdCBjaGFyICpuYW1lLAogewogCXJldHVybiBzbWIyX2NvbXBvdW5kX29wKHhpZCwgdGNv
biwgY2lmc19zYiwgbmFtZSwgREVMRVRFLCBGSUxFX09QRU4sCiAJCQkJQ1JFQVRFX0RFTEVURV9P
Tl9DTE9TRSB8IE9QRU5fUkVQQVJTRV9QT0lOVCwKLQkJCQlBQ0xfTk9fTU9ERSwgTlVMTCwgU01C
Ml9PUF9ERUxFVEUsIE5VTEwpOworCQkJCUFDTF9OT19NT0RFLCBOVUxMLCBTTUIyX09QX0RFTEVU
RSwKKwkJCQlmYWxzZSwgZmFsc2UpOwogfQogCiBzdGF0aWMgaW50CiBzbWIyX3NldF9wYXRoX2F0
dHIoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJICAg
Y29uc3QgY2hhciAqZnJvbV9uYW1lLCBjb25zdCBjaGFyICp0b19uYW1lLAogCQkgICBzdHJ1Y3Qg
Y2lmc19zYl9pbmZvICpjaWZzX3NiLCBfX3UzMiBhY2Nlc3MsIGludCBjb21tYW5kLAotCQkgICBz
dHJ1Y3QgY2lmc0ZpbGVJbmZvICpjZmlsZSkKKwkJICAgYm9vbCBjaGVja19vcGVuLCBib29sIHdy
aXRhYmxlX3BhdGgpCiB7CiAJX19sZTE2ICpzbWIyX3RvX25hbWUgPSBOVUxMOwogCWludCByYzsK
QEAgLTY4NSw3ICs3MTksNyBAQCBzbWIyX3NldF9wYXRoX2F0dHIoY29uc3QgdW5zaWduZWQgaW50
IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAl9CiAJcmMgPSBzbWIyX2NvbXBvdW5kX29w
KHhpZCwgdGNvbiwgY2lmc19zYiwgZnJvbV9uYW1lLCBhY2Nlc3MsCiAJCQkgICAgICBGSUxFX09Q
RU4sIDAsIEFDTF9OT19NT0RFLCBzbWIyX3RvX25hbWUsCi0JCQkgICAgICBjb21tYW5kLCBjZmls
ZSk7CisJCQkgICAgICBjb21tYW5kLCBjaGVja19vcGVuLCB3cml0YWJsZV9wYXRoKTsKIHNtYjJf
cmVuYW1lX3BhdGg6CiAJa2ZyZWUoc21iMl90b19uYW1lKTsKIAlyZXR1cm4gcmM7CkBAIC02OTYs
MTIgKzczMCw5IEBAIHNtYjJfcmVuYW1lX3BhdGgoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3Ry
dWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJIGNvbnN0IGNoYXIgKmZyb21fbmFtZSwgY29uc3QgY2hh
ciAqdG9fbmFtZSwKIAkJIHN0cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IpCiB7Ci0Jc3RydWN0
IGNpZnNGaWxlSW5mbyAqY2ZpbGU7Ci0KLQljaWZzX2dldF93cml0YWJsZV9wYXRoKHRjb24sIGZy
b21fbmFtZSwgRklORF9XUl9XSVRIX0RFTEVURSwgJmNmaWxlKTsKLQogCXJldHVybiBzbWIyX3Nl
dF9wYXRoX2F0dHIoeGlkLCB0Y29uLCBmcm9tX25hbWUsIHRvX25hbWUsCi0JCQkJICBjaWZzX3Ni
LCBERUxFVEUsIFNNQjJfT1BfUkVOQU1FLCBjZmlsZSk7CisJCQkJICBjaWZzX3NiLCBERUxFVEUs
IFNNQjJfT1BfUkVOQU1FLAorCQkJCSAgdHJ1ZSwgdHJ1ZSk7CiB9CiAKIGludApAQCAtNzExLDcg
Kzc0Miw3IEBAIHNtYjJfY3JlYXRlX2hhcmRsaW5rKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0
cnVjdCBjaWZzX3Rjb24gKnRjb24sCiB7CiAJcmV0dXJuIHNtYjJfc2V0X3BhdGhfYXR0cih4aWQs
IHRjb24sIGZyb21fbmFtZSwgdG9fbmFtZSwgY2lmc19zYiwKIAkJCQkgIEZJTEVfUkVBRF9BVFRS
SUJVVEVTLCBTTUIyX09QX0hBUkRMSU5LLAotCQkJCSAgTlVMTCk7CisJCQkJICBmYWxzZSwgZmFs
c2UpOwogfQogCiBpbnQKQEAgLTcyMyw3ICs3NTQsOCBAQCBzbWIyX3NldF9wYXRoX3NpemUoY29u
c3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAogCXJldHVybiBz
bWIyX2NvbXBvdW5kX29wKHhpZCwgdGNvbiwgY2lmc19zYiwgZnVsbF9wYXRoLAogCQkJCUZJTEVf
V1JJVEVfREFUQSwgRklMRV9PUEVOLCAwLCBBQ0xfTk9fTU9ERSwKLQkJCQkmZW9mLCBTTUIyX09Q
X1NFVF9FT0YsIE5VTEwpOworCQkJCSZlb2YsIFNNQjJfT1BfU0VUX0VPRiwKKwkJCQlmYWxzZSwg
ZmFsc2UpOwogfQogCiBpbnQKQEAgLTc0NSw3ICs3NzcsOCBAQCBzbWIyX3NldF9maWxlX2luZm8o
c3RydWN0IGlub2RlICppbm9kZSwgY29uc3QgY2hhciAqZnVsbF9wYXRoLAogCiAJcmMgPSBzbWIy
X2NvbXBvdW5kX29wKHhpZCwgdGxpbmtfdGNvbih0bGluayksIGNpZnNfc2IsIGZ1bGxfcGF0aCwK
IAkJCSAgICAgIEZJTEVfV1JJVEVfQVRUUklCVVRFUywgRklMRV9PUEVOLAotCQkJICAgICAgMCwg
QUNMX05PX01PREUsIGJ1ZiwgU01CMl9PUF9TRVRfSU5GTywgTlVMTCk7CisJCQkgICAgICAwLCBB
Q0xfTk9fTU9ERSwgYnVmLCBTTUIyX09QX1NFVF9JTkZPLAorCQkJCSAgZmFsc2UsIGZhbHNlKTsK
IAljaWZzX3B1dF90bGluayh0bGluayk7CiAJcmV0dXJuIHJjOwogfQpkaWZmIC0tZ2l0IGEvZnMv
Y2lmcy9zbWIyb3BzLmMgYi9mcy9jaWZzL3NtYjJvcHMuYwppbmRleCA2NmIyMDc2MmMyYzkuLjll
Mzg1NGU3NWRmNSAxMDA2NDQKLS0tIGEvZnMvY2lmcy9zbWIyb3BzLmMKKysrIGIvZnMvY2lmcy9z
bWIyb3BzLmMKQEAgLTEyMjEsNyArMTIyMSw3IEBAIHNtYjJfcXVlcnlfZWFzKGNvbnN0IHVuc2ln
bmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCiAKIAogc3RhdGljIGludAotc21i
Ml9zZXRfZWEoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwK
K3NtYjJfc2V0X2VhX2ZpbmFsKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rj
b24gKnRjb24sCiAJICAgIGNvbnN0IGNoYXIgKnBhdGgsIGNvbnN0IGNoYXIgKmVhX25hbWUsIGNv
bnN0IHZvaWQgKmVhX3ZhbHVlLAogCSAgICBjb25zdCBfX3UxNiBlYV92YWx1ZV9sZW4sIGNvbnN0
IHN0cnVjdCBubHNfdGFibGUgKm5sc19jb2RlcGFnZSwKIAkgICAgc3RydWN0IGNpZnNfc2JfaW5m
byAqY2lmc19zYikKQEAgLTEzNzYsNiArMTM3NiwyMyBAQCBzbWIyX3NldF9lYShjb25zdCB1bnNp
Z25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCWZyZWVfcnNwX2J1ZihyZXNw
X2J1ZnR5cGVbMl0sIHJzcF9pb3ZbMl0uaW92X2Jhc2UpOwogCXJldHVybiByYzsKIH0KKworc3Rh
dGljIGludAorc21iMl9zZXRfZWEoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNf
dGNvbiAqdGNvbiwKKwkgICAgY29uc3QgY2hhciAqcGF0aCwgY29uc3QgY2hhciAqZWFfbmFtZSwg
Y29uc3Qgdm9pZCAqZWFfdmFsdWUsCisJICAgIGNvbnN0IF9fdTE2IGVhX3ZhbHVlX2xlbiwgY29u
c3Qgc3RydWN0IG5sc190YWJsZSAqbmxzX2NvZGVwYWdlLAorCSAgICBzdHJ1Y3QgY2lmc19zYl9p
bmZvICpjaWZzX3NiKQoreworCWludCByYzsKKworCWRvIHsKKwkJcmMgPSBzbWIyX3NldF9lYV9m
aW5hbCh4aWQsIHRjb24sIHBhdGgsCisJCQkJZWFfbmFtZSwgZWFfdmFsdWUsIGVhX3ZhbHVlX2xl
biwKKwkJCQlubHNfY29kZXBhZ2UsIGNpZnNfc2IpOworCX0gd2hpbGUgKHRjb24tPnNlcy0+Y2hh
bl9jb3VudCA+IDEgJiYgcmMgPT0gLUVERUFETEspOworCisJcmV0dXJuIHJjOworfQogI2VuZGlm
CiAKIHN0YXRpYyBib29sCkBAIC0xNTkzLDcgKzE2MTAsNyBAQCBzdHJ1Y3QgaXFpX3ZhcnMgewog
fTsKIAogc3RhdGljIGludAotc21iMl9pb2N0bF9xdWVyeV9pbmZvKGNvbnN0IHVuc2lnbmVkIGlu
dCB4aWQsCitzbWIyX2lvY3RsX3F1ZXJ5X2luZm9fZmluYWwoY29uc3QgdW5zaWduZWQgaW50IHhp
ZCwKIAkJICAgICAgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJICAgICAgc3RydWN0IGNpZnNf
c2JfaW5mbyAqY2lmc19zYiwKIAkJICAgICAgX19sZTE2ICpwYXRoLCBpbnQgaXNfZGlyLApAQCAt
MTgxMyw2ICsxODMwLDIzIEBAIHNtYjJfaW9jdGxfcXVlcnlfaW5mbyhjb25zdCB1bnNpZ25lZCBp
bnQgeGlkLAogCWdvdG8gaXFpbmZfZXhpdDsKIH0KIAorc3RhdGljIGludAorc21iMl9pb2N0bF9x
dWVyeV9pbmZvKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsCisJCSAgICAgIHN0cnVjdCBjaWZzX3Rj
b24gKnRjb24sCisJCSAgICAgIHN0cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IsCisJCSAgICAg
IF9fbGUxNiAqcGF0aCwgaW50IGlzX2RpciwKKwkJICAgICAgdW5zaWduZWQgbG9uZyBwKQorewor
CWludCByYzsKKworCWRvIHsKKwkJcmMgPSBzbWIyX2lvY3RsX3F1ZXJ5X2luZm9fZmluYWwoeGlk
LCB0Y29uLCBjaWZzX3NiLAorCQkJCXBhdGgsIGlzX2RpciwgcCk7IAorCX0gd2hpbGUgKHRjb24t
PnNlcy0+Y2hhbl9jb3VudCA+IDEgJiYgcmMgPT0gLUVERUFETEspOworCisJcmV0dXJuIHJjOwor
fQorCiBzdGF0aWMgc3NpemVfdAogc21iMl9jb3B5Y2h1bmtfcmFuZ2UoY29uc3QgdW5zaWduZWQg
aW50IHhpZCwKIAkJCXN0cnVjdCBjaWZzRmlsZUluZm8gKnNyY2ZpbGUsCkBAIC0yMzAyLDcgKzIz
MzYsNyBAQCBzbWIzX25vdGlmeShjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgZmlsZSAq
cGZpbGUsCiB9CiAKIHN0YXRpYyBpbnQKLXNtYjJfcXVlcnlfZGlyX2ZpcnN0KGNvbnN0IHVuc2ln
bmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCitzbWIyX3F1ZXJ5X2Rpcl9maXJz
dF9maW5hbChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAog
CQkgICAgIGNvbnN0IGNoYXIgKnBhdGgsIHN0cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IsCiAJ
CSAgICAgc3RydWN0IGNpZnNfZmlkICpmaWQsIF9fdTE2IHNlYXJjaF9mbGFncywKIAkJICAgICBz
dHJ1Y3QgY2lmc19zZWFyY2hfaW5mbyAqc3JjaF9pbmYpCkBAIC0yNDIwLDYgKzI0NTQsMjMgQEAg
c21iMl9xdWVyeV9kaXJfZmlyc3QoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNf
dGNvbiAqdGNvbiwKIAlyZXR1cm4gcmM7CiB9CiAKK3N0YXRpYyBpbnQKK3NtYjJfcXVlcnlfZGly
X2ZpcnN0KGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCisJ
CSAgICAgY29uc3QgY2hhciAqcGF0aCwgc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYiwKKwkJ
ICAgICBzdHJ1Y3QgY2lmc19maWQgKmZpZCwgX191MTYgc2VhcmNoX2ZsYWdzLAorCQkgICAgIHN0
cnVjdCBjaWZzX3NlYXJjaF9pbmZvICpzcmNoX2luZikKK3sKKwlpbnQgcmM7CisKKwlkbyB7CisJ
CXJjID0gc21iMl9xdWVyeV9kaXJfZmlyc3RfZmluYWwoeGlkLCB0Y29uLAorCQkJCXBhdGgsIGNp
ZnNfc2IsIGZpZCwgCisJCQkJc2VhcmNoX2ZsYWdzLCBzcmNoX2luZik7IAorCX0gd2hpbGUgKHRj
b24tPnNlcy0+Y2hhbl9jb3VudCA+IDEgJiYgcmMgPT0gLUVERUFETEspOworCisJcmV0dXJuIHJj
OworfQorCiBzdGF0aWMgaW50CiBzbWIyX3F1ZXJ5X2Rpcl9uZXh0KGNvbnN0IHVuc2lnbmVkIGlu
dCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCiAJCSAgICBzdHJ1Y3QgY2lmc19maWQgKmZp
ZCwgX191MTYgc2VhcmNoX2ZsYWdzLApAQCAtMjYxMyw3ICsyNjY0LDcgQEAgc21iMl9zZXRfbmV4
dF9jb21tYW5kKHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sIHN0cnVjdCBzbWJfcnFzdCAqcnFzdCkK
ICAqIENhbGxlciBuZWVkIHRvIGZyZWUgdGhpcyB3aXRoIGZyZWVfcnNwX2J1ZigpLgogICovCiBp
bnQKLXNtYjJfcXVlcnlfaW5mb19jb21wb3VuZChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1
Y3QgY2lmc190Y29uICp0Y29uLAorc21iMl9xdWVyeV9pbmZvX2NvbXBvdW5kX2ZpbmFsKGNvbnN0
IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCiAJCQkgX19sZTE2ICp1
dGYxNl9wYXRoLCB1MzIgZGVzaXJlZF9hY2Nlc3MsCiAJCQkgdTMyIGNsYXNzLCB1MzIgdHlwZSwg
dTMyIG91dHB1dF9sZW4sCiAJCQkgc3RydWN0IGt2ZWMgKnJzcCwgaW50ICpidWZ0eXBlLApAQCAt
MjcwNSw2ICsyNzU2LDI1IEBAIHNtYjJfcXVlcnlfaW5mb19jb21wb3VuZChjb25zdCB1bnNpZ25l
ZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCXJldHVybiByYzsKIH0KIAoraW50
CitzbWIyX3F1ZXJ5X2luZm9fY29tcG91bmQoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0
IGNpZnNfdGNvbiAqdGNvbiwKKwkJCSBfX2xlMTYgKnV0ZjE2X3BhdGgsIHUzMiBkZXNpcmVkX2Fj
Y2VzcywKKwkJCSB1MzIgY2xhc3MsIHUzMiB0eXBlLCB1MzIgb3V0cHV0X2xlbiwKKwkJCSBzdHJ1
Y3Qga3ZlYyAqcnNwLCBpbnQgKmJ1ZnR5cGUsCisJCQkgc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lm
c19zYikKK3sKKwlpbnQgcmM7CisKKwlkbyB7CisJCXJjID0gc21iMl9xdWVyeV9pbmZvX2NvbXBv
dW5kX2ZpbmFsKHhpZCwgdGNvbiwKKwkJCQl1dGYxNl9wYXRoLCBkZXNpcmVkX2FjY2VzcywKKwkJ
CQljbGFzcywgdHlwZSwgb3V0cHV0X2xlbiwKKwkJCQlyc3AsIGJ1ZnR5cGUsIGNpZnNfc2IpOwor
CX0gd2hpbGUgKHRjb24tPnNlcy0+Y2hhbl9jb3VudCA+IDEgJiYgcmMgPT0gLUVERUFETEspOwor
CisJcmV0dXJuIHJjOworfQorCiBzdGF0aWMgaW50CiBzbWIyX3F1ZXJ5ZnMoY29uc3QgdW5zaWdu
ZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkgICAgIHN0cnVjdCBjaWZzX3Ni
X2luZm8gKmNpZnNfc2IsIHN0cnVjdCBrc3RhdGZzICpidWYpCkBAIC0zMDAyLDcgKzMwNzIsNyBA
QCBwYXJzZV9yZXBhcnNlX3BvaW50KHN0cnVjdCByZXBhcnNlX2RhdGFfYnVmZmVyICpidWYsCiAJ
KHNpemVvZihzdHJ1Y3Qgc21iMl9lcnJfcnNwKSAtIDEgKyBzaXplb2Yoc3RydWN0IHNtYjJfc3lt
bGlua19lcnJfcnNwKSkKIAogc3RhdGljIGludAotc21iMl9xdWVyeV9zeW1saW5rKGNvbnN0IHVu
c2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCitzbWIyX3F1ZXJ5X3N5bWxp
bmtfZmluYWwoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwK
IAkJICAgc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYiwgY29uc3QgY2hhciAqZnVsbF9wYXRo
LAogCQkgICBjaGFyICoqdGFyZ2V0X3BhdGgsIGJvb2wgaXNfcmVwYXJzZV9wb2ludCkKIHsKQEAg
LTMxOTAsOCArMzI2MCwyNCBAQCBzbWIyX3F1ZXJ5X3N5bWxpbmsoY29uc3QgdW5zaWduZWQgaW50
IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAlyZXR1cm4gcmM7CiB9CiAKK3N0YXRpYyBp
bnQKK3NtYjJfcXVlcnlfc3ltbGluayhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lm
c190Y29uICp0Y29uLAorCQkgICBzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiLCBjb25zdCBj
aGFyICpmdWxsX3BhdGgsCisJCSAgIGNoYXIgKip0YXJnZXRfcGF0aCwgYm9vbCBpc19yZXBhcnNl
X3BvaW50KQoreworCWludCByYzsKKworCWRvIHsKKwkJcmMgPSBzbWIyX3F1ZXJ5X3N5bWxpbmtf
ZmluYWwoeGlkLCB0Y29uLAorCQkJCWNpZnNfc2IsIGZ1bGxfcGF0aCwgdGFyZ2V0X3BhdGgsCisJ
CQkJaXNfcmVwYXJzZV9wb2ludCk7IAorCX0gd2hpbGUgKHRjb24tPnNlcy0+Y2hhbl9jb3VudCA+
IDEgJiYgcmMgPT0gLUVERUFETEspOworCisJcmV0dXJuIHJjOworfQorCiBpbnQKLXNtYjJfcXVl
cnlfcmVwYXJzZV90YWcoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAq
dGNvbiwKK3NtYjJfcXVlcnlfcmVwYXJzZV90YWdfZmluYWwoY29uc3QgdW5zaWduZWQgaW50IHhp
ZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJICAgc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lm
c19zYiwgY29uc3QgY2hhciAqZnVsbF9wYXRoLAogCQkgICBfX3UzMiAqdGFnKQogewpAQCAtMzMx
Nyw2ICszNDAzLDIxIEBAIHNtYjJfcXVlcnlfcmVwYXJzZV90YWcoY29uc3QgdW5zaWduZWQgaW50
IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAlyZXR1cm4gcmM7CiB9CiAKK2ludAorc21i
Ml9xdWVyeV9yZXBhcnNlX3RhZyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190
Y29uICp0Y29uLAorCQkgICBzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiLCBjb25zdCBjaGFy
ICpmdWxsX3BhdGgsCisJCSAgIF9fdTMyICp0YWcpCit7CisJaW50IHJjOworCisJZG8geworCQly
YyA9IHNtYjJfcXVlcnlfcmVwYXJzZV90YWdfZmluYWwoeGlkLCB0Y29uLAorCQkJCWNpZnNfc2Is
IGZ1bGxfcGF0aCwgdGFnKTsKKwl9IHdoaWxlICh0Y29uLT5zZXMtPmNoYW5fY291bnQgPiAxICYm
IHJjID09IC1FREVBRExLKTsKKworCXJldHVybiByYzsKK30KKwogc3RhdGljIHN0cnVjdCBjaWZz
X250c2QgKgogZ2V0X3NtYjJfYWNsX2J5X2ZpZChzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3Ni
LAogCQkgICAgY29uc3Qgc3RydWN0IGNpZnNfZmlkICpjaWZzZmlkLCB1MzIgKnBhY2xsZW4sIHUz
MiBpbmZvKQpkaWZmIC0tZ2l0IGEvZnMvY2lmcy9zbWIycGR1LmMgYi9mcy9jaWZzL3NtYjJwZHUu
YwppbmRleCBlMzZjMmE4Njc3ODMuLjliMzhiZTVmNWM5YiAxMDA2NDQKLS0tIGEvZnMvY2lmcy9z
bWIycGR1LmMKKysrIGIvZnMvY2lmcy9zbWIycGR1LmMKQEAgLTI0NzUsNyArMjQ3NSw3IEBAIGFs
bG9jX3BhdGhfd2l0aF90cmVlX3ByZWZpeChfX2xlMTYgKipvdXRfcGF0aCwgaW50ICpvdXRfc2l6
ZSwgaW50ICpvdXRfbGVuLAogCXJldHVybiAwOwogfQogCi1pbnQgc21iMzExX3Bvc2l4X21rZGly
KGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBpbm9kZSAqaW5vZGUsCitpbnQgc21iMzEx
X3Bvc2l4X21rZGlyX2ZpbmFsKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBpbm9kZSAq
aW5vZGUsCiAJCQkgICAgICAgdW1vZGVfdCBtb2RlLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAog
CQkJICAgICAgIGNvbnN0IGNoYXIgKmZ1bGxfcGF0aCwKIAkJCSAgICAgICBzdHJ1Y3QgY2lmc19z
Yl9pbmZvICpjaWZzX3NiKQpAQCAtMjYyOCw2ICsyNjI4LDIyIEBAIGludCBzbWIzMTFfcG9zaXhf
bWtkaXIoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGlub2RlICppbm9kZSwKIAlyZXR1
cm4gcmM7CiB9CiAKK2ludCBzbWIzMTFfcG9zaXhfbWtkaXIoY29uc3QgdW5zaWduZWQgaW50IHhp
ZCwgc3RydWN0IGlub2RlICppbm9kZSwKKwkJCSAgICAgICB1bW9kZV90IG1vZGUsIHN0cnVjdCBj
aWZzX3Rjb24gKnRjb24sCisJCQkgICAgICAgY29uc3QgY2hhciAqZnVsbF9wYXRoLAorCQkJICAg
ICAgIHN0cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IpCit7CisJaW50IHJjOworCisJZG8gewor
CQlyYyA9IHNtYjMxMV9wb3NpeF9ta2Rpcl9maW5hbCh4aWQsIGlub2RlLAorCQkJCW1vZGUsIHRj
b24sIGZ1bGxfcGF0aCwKKwkJCQljaWZzX3NiKTsgCisJfSB3aGlsZSAodGNvbi0+c2VzLT5jaGFu
X2NvdW50ID4gMSAmJiByYyA9PSAtRURFQURMSyk7CisKKwlyZXR1cm4gcmM7Cit9CisKIGludAog
U01CMl9vcGVuX2luaXQoc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwgc3RydWN0IFRDUF9TZXJ2ZXJf
SW5mbyAqc2VydmVyLAogCSAgICAgICBzdHJ1Y3Qgc21iX3Jxc3QgKnJxc3QsIF9fdTggKm9wbG9j
aywKQEAgLTI4MjMsNyArMjgzOSw3IEBAIFNNQjJfb3Blbl9mcmVlKHN0cnVjdCBzbWJfcnFzdCAq
cnFzdCkKIH0KIAogaW50Ci1TTUIyX29wZW4oY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0
IGNpZnNfb3Blbl9wYXJtcyAqb3Bhcm1zLCBfX2xlMTYgKnBhdGgsCitTTUIyX29wZW5fZmluYWwo
Y29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfb3Blbl9wYXJtcyAqb3Bhcm1zLCBf
X2xlMTYgKnBhdGgsCiAJICBfX3U4ICpvcGxvY2ssIHN0cnVjdCBzbWIyX2ZpbGVfYWxsX2luZm8g
KmJ1ZiwKIAkgIHN0cnVjdCBjcmVhdGVfcG9zaXhfcnNwICpwb3NpeCwKIAkgIHN0cnVjdCBrdmVj
ICplcnJfaW92LCBpbnQgKmJ1ZnR5cGUpCkBAIC0yOTExLDYgKzI5MjcsMjQgQEAgU01CMl9vcGVu
KGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX29wZW5fcGFybXMgKm9wYXJtcywg
X19sZTE2ICpwYXRoLAogCXJldHVybiByYzsKIH0KIAoraW50CitTTUIyX29wZW4oY29uc3QgdW5z
aWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfb3Blbl9wYXJtcyAqb3Bhcm1zLCBfX2xlMTYgKnBh
dGgsCisJICBfX3U4ICpvcGxvY2ssIHN0cnVjdCBzbWIyX2ZpbGVfYWxsX2luZm8gKmJ1ZiwKKwkg
IHN0cnVjdCBjcmVhdGVfcG9zaXhfcnNwICpwb3NpeCwKKwkgIHN0cnVjdCBrdmVjICplcnJfaW92
LCBpbnQgKmJ1ZnR5cGUpCit7CisJaW50IHJjOworCXN0cnVjdCBjaWZzX3Rjb24gKnRjb24gPSBv
cGFybXMtPnRjb247CisKKwlkbyB7CisJCXJjID0gU01CMl9vcGVuX2ZpbmFsKHhpZCwgb3Bhcm1z
LCBwYXRoLAorCQkJCW9wbG9jaywgYnVmLAorCQkJCXBvc2l4LCBlcnJfaW92LCBidWZ0eXBlKTsK
Kwl9IHdoaWxlICh0Y29uLT5zZXMtPmNoYW5fY291bnQgPiAxICYmIHJjID09IC1FREVBRExLKTsK
KworCXJldHVybiByYzsKK30KKwogaW50CiBTTUIyX2lvY3RsX2luaXQoc3RydWN0IGNpZnNfdGNv
biAqdGNvbiwgc3RydWN0IFRDUF9TZXJ2ZXJfSW5mbyAqc2VydmVyLAogCQlzdHJ1Y3Qgc21iX3Jx
c3QgKnJxc3QsCkBAIC0zMDE5LDcgKzMwNTMsNyBAQCBTTUIyX2lvY3RsX2ZyZWUoc3RydWN0IHNt
Yl9ycXN0ICpycXN0KQogICoJU01CMiBJT0NUTCBpcyB1c2VkIGZvciBib3RoIElPQ1RMcyBhbmQg
RlNDVExzCiAgKi8KIGludAotU01CMl9pb2N0bChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1
Y3QgY2lmc190Y29uICp0Y29uLCB1NjQgcGVyc2lzdGVudF9maWQsCitTTUIyX2lvY3RsX2ZpbmFs
KGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sIHU2NCBwZXJz
aXN0ZW50X2ZpZCwKIAkgICB1NjQgdm9sYXRpbGVfZmlkLCB1MzIgb3Bjb2RlLCBib29sIGlzX2Zz
Y3RsLAogCSAgIGNoYXIgKmluX2RhdGEsIHUzMiBpbmRhdGFsZW4sIHUzMiBtYXhfb3V0X2RhdGFf
bGVuLAogCSAgIGNoYXIgKipvdXRfZGF0YSwgdTMyICpwbGVuIC8qIHJldHVybmVkIGRhdGEgbGVu
ICovKQpAQCAtMzEzMCw2ICszMTY0LDI1IEBAIFNNQjJfaW9jdGwoY29uc3QgdW5zaWduZWQgaW50
IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwgdTY0IHBlcnNpc3RlbnRfZmlkLAogCXJldHVy
biByYzsKIH0KIAoraW50CitTTUIyX2lvY3RsKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVj
dCBjaWZzX3Rjb24gKnRjb24sIHU2NCBwZXJzaXN0ZW50X2ZpZCwKKwkgICB1NjQgdm9sYXRpbGVf
ZmlkLCB1MzIgb3Bjb2RlLCBib29sIGlzX2ZzY3RsLAorCSAgIGNoYXIgKmluX2RhdGEsIHUzMiBp
bmRhdGFsZW4sIHUzMiBtYXhfb3V0X2RhdGFfbGVuLAorCSAgIGNoYXIgKipvdXRfZGF0YSwgdTMy
ICpwbGVuIC8qIHJldHVybmVkIGRhdGEgbGVuICovKQoreworCWludCByYzsKKworCWRvIHsKKwkJ
cmMgPSBTTUIyX2lvY3RsX2ZpbmFsKHhpZCwgdGNvbiwKKwkJCQlwZXJzaXN0ZW50X2ZpZCwgdm9s
YXRpbGVfZmlkLAorCQkJCW9wY29kZSwgaXNfZnNjdGwsCisJCQkJaW5fZGF0YSwgaW5kYXRhbGVu
LAorCQkJCW1heF9vdXRfZGF0YV9sZW4sIG91dF9kYXRhLCBwbGVuKTsKKwl9IHdoaWxlICh0Y29u
LT5zZXMtPmNoYW5fY291bnQgPiAxICYmIHJjID09IC1FREVBRExLKTsKKworCXJldHVybiByYzsK
K30KKwogLyoKICAqICAgSW5kaXZpZHVhbCBjYWxsZXJzIHRvIGlvY3RsIHdvcmtlciBmdW5jdGlv
biBmb2xsb3cKICAqLwpAQCAtMzE5MSw3ICszMjQ0LDcgQEAgU01CMl9jbG9zZV9mcmVlKHN0cnVj
dCBzbWJfcnFzdCAqcnFzdCkKIH0KIAogaW50Ci1fX1NNQjJfY2xvc2UoY29uc3QgdW5zaWduZWQg
aW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKK19fU01CMl9jbG9zZV9maW5hbChjb25z
dCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCSAgICAgdTY0IHBl
cnNpc3RlbnRfZmlkLCB1NjQgdm9sYXRpbGVfZmlkLAogCSAgICAgc3RydWN0IHNtYjJfZmlsZV9u
ZXR3b3JrX29wZW5faW5mbyAqcGJ1ZikKIHsKQEAgLTMyNjgsNiArMzMyMSwyMiBAQCBfX1NNQjJf
Y2xvc2UoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAly
ZXR1cm4gcmM7CiB9CiAKK2ludAorX19TTUIyX2Nsb3NlKGNvbnN0IHVuc2lnbmVkIGludCB4aWQs
IHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCisJICAgICB1NjQgcGVyc2lzdGVudF9maWQsIHU2NCB2
b2xhdGlsZV9maWQsCisJICAgICBzdHJ1Y3Qgc21iMl9maWxlX25ldHdvcmtfb3Blbl9pbmZvICpw
YnVmKQoreworCWludCByYzsKKworCWRvIHsKKwkJcmMgPSBfX1NNQjJfY2xvc2VfZmluYWwoeGlk
LCB0Y29uLAorCQkJCXBlcnNpc3RlbnRfZmlkLCB2b2xhdGlsZV9maWQsCisJCQkJcGJ1Zik7CisJ
fSB3aGlsZSAodGNvbi0+c2VzLT5jaGFuX2NvdW50ID4gMSAmJiByYyA9PSAtRURFQURMSyk7CisK
KwlyZXR1cm4gcmM7Cit9CisKIGludAogU01CMl9jbG9zZShjb25zdCB1bnNpZ25lZCBpbnQgeGlk
LCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCQl1NjQgcGVyc2lzdGVudF9maWQsIHU2NCB2b2xh
dGlsZV9maWQpCkBAIC0zMzc1LDcgKzM0NDQsNyBAQCBTTUIyX3F1ZXJ5X2luZm9fZnJlZShzdHJ1
Y3Qgc21iX3Jxc3QgKnJxc3QpCiB9CiAKIHN0YXRpYyBpbnQKLXF1ZXJ5X2luZm8oY29uc3QgdW5z
aWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKK3F1ZXJ5X2luZm9fZmluYWwo
Y29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkgICB1NjQg
cGVyc2lzdGVudF9maWQsIHU2NCB2b2xhdGlsZV9maWQsIHU4IGluZm9fY2xhc3MsIHU4IGluZm9f
dHlwZSwKIAkgICB1MzIgYWRkaXRpb25hbF9pbmZvLCBzaXplX3Qgb3V0cHV0X2xlbiwgc2l6ZV90
IG1pbl9sZW4sIHZvaWQgKipkYXRhLAogCQl1MzIgKmRsZW4pCkBAIC0zNDYyLDYgKzM1MzEsMjYg
QEAgcXVlcnlfaW5mbyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0
Y29uLAogCXJldHVybiByYzsKIH0KIAorc3RhdGljIGludAorcXVlcnlfaW5mbyhjb25zdCB1bnNp
Z25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAorCSAgIHU2NCBwZXJzaXN0ZW50
X2ZpZCwgdTY0IHZvbGF0aWxlX2ZpZCwgdTggaW5mb19jbGFzcywgdTggaW5mb190eXBlLAorCSAg
IHUzMiBhZGRpdGlvbmFsX2luZm8sIHNpemVfdCBvdXRwdXRfbGVuLCBzaXplX3QgbWluX2xlbiwg
dm9pZCAqKmRhdGEsCisJCXUzMiAqZGxlbikKK3sKKwlpbnQgcmM7CisKKwlkbyB7CisJCXJjID0g
cXVlcnlfaW5mb19maW5hbCh4aWQsIHRjb24sCisJCQkJcGVyc2lzdGVudF9maWQsIHZvbGF0aWxl
X2ZpZCwKKwkJCQlpbmZvX2NsYXNzLCBpbmZvX3R5cGUsCisJCQkJYWRkaXRpb25hbF9pbmZvLAor
CQkJCW91dHB1dF9sZW4sIG1pbl9sZW4sCisJCQkJZGF0YSwgZGxlbik7CisJfSB3aGlsZSAodGNv
bi0+c2VzLT5jaGFuX2NvdW50ID4gMSAmJiByYyA9PSAtRURFQURMSyk7CisKKwlyZXR1cm4gcmM7
Cit9CisKIGludCBTTUIyX3F1ZXJ5X2luZm8oY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0
IGNpZnNfdGNvbiAqdGNvbiwKIAl1NjQgcGVyc2lzdGVudF9maWQsIHU2NCB2b2xhdGlsZV9maWQs
IHN0cnVjdCBzbWIyX2ZpbGVfYWxsX2luZm8gKmRhdGEpCiB7CkBAIC0zNTQ5LDcgKzM2MzgsNyBA
QCBTTUIyX25vdGlmeV9pbml0KGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBzbWJfcnFz
dCAqcnFzdCwKIH0KIAogaW50Ci1TTUIyX2NoYW5nZV9ub3RpZnkoY29uc3QgdW5zaWduZWQgaW50
IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKK1NNQjJfY2hhbmdlX25vdGlmeV9maW5hbChj
b25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCQl1NjQgcGVy
c2lzdGVudF9maWQsIHU2NCB2b2xhdGlsZV9maWQsIGJvb2wgd2F0Y2hfdHJlZSwKIAkJdTMyIGNv
bXBsZXRpb25fZmlsdGVyKQogewpAQCAtMzYwMCw3ICszNjg5LDIxIEBAIFNNQjJfY2hhbmdlX25v
dGlmeShjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCXJl
dHVybiByYzsKIH0KIAoraW50CitTTUIyX2NoYW5nZV9ub3RpZnkoY29uc3QgdW5zaWduZWQgaW50
IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKKwkJdTY0IHBlcnNpc3RlbnRfZmlkLCB1NjQg
dm9sYXRpbGVfZmlkLCBib29sIHdhdGNoX3RyZWUsCisJCXUzMiBjb21wbGV0aW9uX2ZpbHRlcikK
K3sKKwlpbnQgcmM7CiAKKwlkbyB7CisJCXJjID0gU01CMl9jaGFuZ2Vfbm90aWZ5X2ZpbmFsKHhp
ZCwgdGNvbiwKKwkJCQlwZXJzaXN0ZW50X2ZpZCwgdm9sYXRpbGVfZmlkLAorCQkJCXdhdGNoX3Ry
ZWUsIGNvbXBsZXRpb25fZmlsdGVyKTsKKwl9IHdoaWxlICh0Y29uLT5zZXMtPmNoYW5fY291bnQg
PiAxICYmIHJjID09IC1FREVBRExLKTsKKworCXJldHVybiByYzsKK30KIAogLyoKICAqIFRoaXMg
aXMgYSBuby1vcCBmb3Igbm93LiBXZSdyZSBub3QgcmVhbGx5IGludGVyZXN0ZWQgaW4gdGhlIHJl
cGx5LCBidXQKQEAgLTM3NjQsNyArMzg2Nyw3IEBAIFNNQjJfZmx1c2hfaW5pdChjb25zdCB1bnNp
Z25lZCBpbnQgeGlkLCBzdHJ1Y3Qgc21iX3Jxc3QgKnJxc3QsCiB9CiAKIGludAotU01CMl9mbHVz
aChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLCB1NjQgcGVy
c2lzdGVudF9maWQsCitTTUIyX2ZsdXNoX2ZpbmFsKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0
cnVjdCBjaWZzX3Rjb24gKnRjb24sIHU2NCBwZXJzaXN0ZW50X2ZpZCwKIAkgICB1NjQgdm9sYXRp
bGVfZmlkKQogewogCXN0cnVjdCBjaWZzX3NlcyAqc2VzID0gdGNvbi0+c2VzOwpAQCAtMzgxMSw2
ICszOTE0LDIwIEBAIFNNQjJfZmx1c2goY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNp
ZnNfdGNvbiAqdGNvbiwgdTY0IHBlcnNpc3RlbnRfZmlkLAogCXJldHVybiByYzsKIH0KIAoraW50
CitTTUIyX2ZsdXNoKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRj
b24sIHU2NCBwZXJzaXN0ZW50X2ZpZCwKKwkgICB1NjQgdm9sYXRpbGVfZmlkKQoreworCWludCBy
YzsKKworCWRvIHsKKwkJcmMgPSBTTUIyX2ZsdXNoX2ZpbmFsKHhpZCwgdGNvbiwKKwkJCQlwZXJz
aXN0ZW50X2ZpZCwgdm9sYXRpbGVfZmlkKTsKKwl9IHdoaWxlICh0Y29uLT5zZXMtPmNoYW5fY291
bnQgPiAxICYmIHJjID09IC1FREVBRExLKTsKKworCXJldHVybiByYzsKK30KKwogLyoKICAqIFRv
IGZvcm0gYSBjaGFpbiBvZiByZWFkIHJlcXVlc3RzLCBhbnkgcmVhZCByZXF1ZXN0cyBhZnRlciB0
aGUgZmlyc3Qgc2hvdWxkCiAgKiBoYXZlIHRoZSBlbmRfb2ZfY2hhaW4gYm9vbGVhbiBzZXQgdG8g
dHJ1ZS4KQEAgLTM5OTcsOSArNDExNCw4IEBAIHNtYjJfcmVhZHZfY2FsbGJhY2soc3RydWN0IG1p
ZF9xX2VudHJ5ICptaWQpCiAJYWRkX2NyZWRpdHMoc2VydmVyLCAmY3JlZGl0cywgMCk7CiB9CiAK
LS8qIHNtYjJfYXN5bmNfcmVhZHYgLSBzZW5kIGFuIGFzeW5jIHJlYWQsIGFuZCBzZXQgdXAgbWlk
IHRvIGhhbmRsZSByZXN1bHQgKi8KIGludAotc21iMl9hc3luY19yZWFkdihzdHJ1Y3QgY2lmc19y
ZWFkZGF0YSAqcmRhdGEpCitzbWIyX2FzeW5jX3JlYWR2X2ZpbmFsKHN0cnVjdCBjaWZzX3JlYWRk
YXRhICpyZGF0YSkKIHsKIAlpbnQgcmMsIGZsYWdzID0gMDsKIAljaGFyICpidWY7CkBAIC00MDY5
LDggKzQxODUsMjQgQEAgc21iMl9hc3luY19yZWFkdihzdHJ1Y3QgY2lmc19yZWFkZGF0YSAqcmRh
dGEpCiAJcmV0dXJuIHJjOwogfQogCisvKiBzbWIyX2FzeW5jX3JlYWR2IC0gc2VuZCBhbiBhc3lu
YyByZWFkLCBhbmQgc2V0IHVwIG1pZCB0byBoYW5kbGUgcmVzdWx0ICovCiBpbnQKLVNNQjJfcmVh
ZChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc19pb19wYXJtcyAqaW9fcGFybXMs
CitzbWIyX2FzeW5jX3JlYWR2KHN0cnVjdCBjaWZzX3JlYWRkYXRhICpyZGF0YSkKK3sKKwlpbnQg
cmM7CisJc3RydWN0IGNpZnNfdGNvbiAqdGNvbiA9IHRsaW5rX3Rjb24ocmRhdGEtPmNmaWxlLT50
bGluayk7CisKKwlkbyB7CisJCXJjID0gc21iMl9hc3luY19yZWFkdl9maW5hbChyZGF0YSk7CisJ
fSB3aGlsZSAoIXJkYXRhLT5zZXJ2ZXIgJiYKKwkJCXRjb24tPnNlcy0+Y2hhbl9jb3VudCA+IDEg
JiYKKwkJCXJjID09IC1FREVBRExLKTsKKworCXJldHVybiByYzsKK30KKworaW50CitTTUIyX3Jl
YWRfZmluYWwoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfaW9fcGFybXMgKmlv
X3Bhcm1zLAogCSAgdW5zaWduZWQgaW50ICpuYnl0ZXMsIGNoYXIgKipidWYsIGludCAqYnVmX3R5
cGUpCiB7CiAJc3RydWN0IHNtYl9ycXN0IHJxc3Q7CkBAIC00MTQ5LDYgKzQyODEsMjMgQEAgU01C
Ml9yZWFkKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX2lvX3Bhcm1zICppb19w
YXJtcywKIAlyZXR1cm4gcmM7CiB9CiAKK2ludAorU01CMl9yZWFkKGNvbnN0IHVuc2lnbmVkIGlu
dCB4aWQsIHN0cnVjdCBjaWZzX2lvX3Bhcm1zICppb19wYXJtcywKKwkgIHVuc2lnbmVkIGludCAq
bmJ5dGVzLCBjaGFyICoqYnVmLCBpbnQgKmJ1Zl90eXBlKQoreworCWludCByYzsKKwlzdHJ1Y3Qg
Y2lmc190Y29uICp0Y29uID0gaW9fcGFybXMtPnRjb247CisKKwlkbyB7CisJCXJjID0gU01CMl9y
ZWFkX2ZpbmFsKHhpZCwgaW9fcGFybXMsCisJCQkJbmJ5dGVzLCBidWYsIGJ1Zl90eXBlKTsKKwl9
IHdoaWxlICghaW9fcGFybXMtPnNlcnZlciAmJgorCQkJdGNvbi0+c2VzLT5jaGFuX2NvdW50ID4g
MSAmJgorCQkJcmMgPT0gLUVERUFETEspOworCisJcmV0dXJuIHJjOworfQorCiAvKgogICogQ2hl
Y2sgdGhlIG1pZF9zdGF0ZSBhbmQgc2lnbmF0dXJlIG9uIHJlY2VpdmVkIGJ1ZmZlciAoaWYgYW55
KSwgYW5kIHF1ZXVlIHRoZQogICogd29ya3F1ZXVlIGNvbXBsZXRpb24gdGFzay4KQEAgLTQyMzUs
OSArNDM4NCw4IEBAIHNtYjJfd3JpdGV2X2NhbGxiYWNrKHN0cnVjdCBtaWRfcV9lbnRyeSAqbWlk
KQogCWFkZF9jcmVkaXRzKHNlcnZlciwgJmNyZWRpdHMsIDApOwogfQogCi0vKiBzbWIyX2FzeW5j
X3dyaXRldiAtIHNlbmQgYW4gYXN5bmMgd3JpdGUsIGFuZCBzZXQgdXAgbWlkIHRvIGhhbmRsZSBy
ZXN1bHQgKi8KIGludAotc21iMl9hc3luY193cml0ZXYoc3RydWN0IGNpZnNfd3JpdGVkYXRhICp3
ZGF0YSwKK3NtYjJfYXN5bmNfd3JpdGV2X2ZpbmFsKHN0cnVjdCBjaWZzX3dyaXRlZGF0YSAqd2Rh
dGEsCiAJCSAgdm9pZCAoKnJlbGVhc2UpKHN0cnVjdCBrcmVmICprcmVmKSkKIHsKIAlpbnQgcmMg
PSAtRUFDQ0VTLCBmbGFncyA9IDA7CkBAIC00MzczLDE0ICs0NTIxLDI1IEBAIHNtYjJfYXN5bmNf
d3JpdGV2KHN0cnVjdCBjaWZzX3dyaXRlZGF0YSAqd2RhdGEsCiAJcmV0dXJuIHJjOwogfQogCi0v
KgotICogU01CMl93cml0ZSBmdW5jdGlvbiBnZXRzIGlvdiBwb2ludGVyIHRvIGt2ZWMgYXJyYXkg
d2l0aCBuX3ZlYyBhcyBhIGxlbmd0aC4KLSAqIFRoZSBsZW5ndGggZmllbGQgZnJvbSBpb19wYXJt
cyBtdXN0IGJlIGF0IGxlYXN0IDEgYW5kIGluZGljYXRlcyBhIG51bWJlciBvZgotICogZWxlbWVu
dHMgd2l0aCBkYXRhIHRvIHdyaXRlIHRoYXQgYmVnaW5zIHdpdGggcG9zaXRpb24gMSBpbiBpb3Yg
YXJyYXkuIEFsbAotICogZGF0YSBsZW5ndGggaXMgc3BlY2lmaWVkIGJ5IGNvdW50LgotICovCisv
KiBzbWIyX2FzeW5jX3dyaXRldiAtIHNlbmQgYW4gYXN5bmMgd3JpdGUsIGFuZCBzZXQgdXAgbWlk
IHRvIGhhbmRsZSByZXN1bHQgKi8KIGludAotU01CMl93cml0ZShjb25zdCB1bnNpZ25lZCBpbnQg
eGlkLCBzdHJ1Y3QgY2lmc19pb19wYXJtcyAqaW9fcGFybXMsCitzbWIyX2FzeW5jX3dyaXRldihz
dHJ1Y3QgY2lmc193cml0ZWRhdGEgKndkYXRhLAorCQkgIHZvaWQgKCpyZWxlYXNlKShzdHJ1Y3Qg
a3JlZiAqa3JlZikpCit7CisJaW50IHJjOworCXN0cnVjdCBjaWZzX3Rjb24gKnRjb24gPSB0bGlu
a190Y29uKHdkYXRhLT5jZmlsZS0+dGxpbmspOworCisJZG8geworCQlyYyA9IHNtYjJfYXN5bmNf
d3JpdGV2X2ZpbmFsKHdkYXRhLCByZWxlYXNlKTsKKwl9IHdoaWxlICghd2RhdGEtPnNlcnZlciAm
JgorCQkJdGNvbi0+c2VzLT5jaGFuX2NvdW50ID4gMSAmJgorCQkJcmMgPT0gLUVERUFETEspOwor
CisJcmV0dXJuIHJjOworfQorCitpbnQKK1NNQjJfd3JpdGVfZmluYWwoY29uc3QgdW5zaWduZWQg
aW50IHhpZCwgc3RydWN0IGNpZnNfaW9fcGFybXMgKmlvX3Bhcm1zLAogCSAgIHVuc2lnbmVkIGlu
dCAqbmJ5dGVzLCBzdHJ1Y3Qga3ZlYyAqaW92LCBpbnQgbl92ZWMpCiB7CiAJc3RydWN0IHNtYl9y
cXN0IHJxc3Q7CkBAIC00NDYyLDYgKzQ2MjEsMjkgQEAgU01CMl93cml0ZShjb25zdCB1bnNpZ25l
ZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc19pb19wYXJtcyAqaW9fcGFybXMsCiAJcmV0dXJuIHJjOwog
fQogCisvKgorICogU01CMl93cml0ZSBmdW5jdGlvbiBnZXRzIGlvdiBwb2ludGVyIHRvIGt2ZWMg
YXJyYXkgd2l0aCBuX3ZlYyBhcyBhIGxlbmd0aC4KKyAqIFRoZSBsZW5ndGggZmllbGQgZnJvbSBp
b19wYXJtcyBtdXN0IGJlIGF0IGxlYXN0IDEgYW5kIGluZGljYXRlcyBhIG51bWJlciBvZgorICog
ZWxlbWVudHMgd2l0aCBkYXRhIHRvIHdyaXRlIHRoYXQgYmVnaW5zIHdpdGggcG9zaXRpb24gMSBp
biBpb3YgYXJyYXkuIEFsbAorICogZGF0YSBsZW5ndGggaXMgc3BlY2lmaWVkIGJ5IGNvdW50Lgor
ICovCitpbnQKK1NNQjJfd3JpdGUoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNf
aW9fcGFybXMgKmlvX3Bhcm1zLAorCSAgIHVuc2lnbmVkIGludCAqbmJ5dGVzLCBzdHJ1Y3Qga3Zl
YyAqaW92LCBpbnQgbl92ZWMpCit7CisJaW50IHJjOworCXN0cnVjdCBjaWZzX3Rjb24gKnRjb24g
PSBpb19wYXJtcy0+dGNvbjsKKworCWRvIHsKKwkJcmMgPSBTTUIyX3dyaXRlX2ZpbmFsKHhpZCwg
aW9fcGFybXMsCisJCQkJbmJ5dGVzLCBpb3YsIG5fdmVjKTsKKwl9IHdoaWxlICghaW9fcGFybXMt
PnNlcnZlciAmJgorCQkJdGNvbi0+c2VzLT5jaGFuX2NvdW50ID4gMSAmJgorCQkJcmMgPT0gLUVE
RUFETEspOworCisJcmV0dXJuIHJjOworfQorCiBpbnQgcG9zaXhfaW5mb19zaWRfc2l6ZShjb25z
dCB2b2lkICpiZWcsIGNvbnN0IHZvaWQgKmVuZCkKIHsKIAlzaXplX3Qgc3ViYXV0aDsKQEAgLTQ3
NjEsNyArNDk0Myw3IEBAIHNtYjJfcGFyc2VfcXVlcnlfZGlyZWN0b3J5KHN0cnVjdCBjaWZzX3Rj
b24gKnRjb24sCiB9CiAKIGludAotU01CMl9xdWVyeV9kaXJlY3RvcnkoY29uc3QgdW5zaWduZWQg
aW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKK1NNQjJfcXVlcnlfZGlyZWN0b3J5X2Zp
bmFsKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCiAJCSAg
ICAgdTY0IHBlcnNpc3RlbnRfZmlkLCB1NjQgdm9sYXRpbGVfZmlkLCBpbnQgaW5kZXgsCiAJCSAg
ICAgc3RydWN0IGNpZnNfc2VhcmNoX2luZm8gKnNyY2hfaW5mKQogewpAQCAtNDgzMCw2ICs1MDEy
LDIyIEBAIFNNQjJfcXVlcnlfZGlyZWN0b3J5KGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVj
dCBjaWZzX3Rjb24gKnRjb24sCiAJcmV0dXJuIHJjOwogfQogCitpbnQKK1NNQjJfcXVlcnlfZGly
ZWN0b3J5KGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCisJ
CSAgICAgdTY0IHBlcnNpc3RlbnRfZmlkLCB1NjQgdm9sYXRpbGVfZmlkLCBpbnQgaW5kZXgsCisJ
CSAgICAgc3RydWN0IGNpZnNfc2VhcmNoX2luZm8gKnNyY2hfaW5mKQoreworCWludCByYzsKKwor
CWRvIHsKKwkJcmMgPSBTTUIyX3F1ZXJ5X2RpcmVjdG9yeV9maW5hbCh4aWQsIHRjb24sCisJCQkJ
cGVyc2lzdGVudF9maWQsIHZvbGF0aWxlX2ZpZCwgaW5kZXgsCisJCQkJc3JjaF9pbmYpOworCX0g
d2hpbGUgKHRjb24tPnNlcy0+Y2hhbl9jb3VudCA+IDEgJiYgcmMgPT0gLUVERUFETEspOworCisJ
cmV0dXJuIHJjOworfQorCiBpbnQKIFNNQjJfc2V0X2luZm9faW5pdChzdHJ1Y3QgY2lmc190Y29u
ICp0Y29uLCBzdHJ1Y3QgVENQX1NlcnZlcl9JbmZvICpzZXJ2ZXIsCiAJCSAgIHN0cnVjdCBzbWJf
cnFzdCAqcnFzdCwKQEAgLTQ4ODIsNyArNTA4MCw3IEBAIFNNQjJfc2V0X2luZm9fZnJlZShzdHJ1
Y3Qgc21iX3Jxc3QgKnJxc3QpCiB9CiAKIHN0YXRpYyBpbnQKLXNlbmRfc2V0X2luZm8oY29uc3Qg
dW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKK3NlbmRfc2V0X2luZm9f
ZmluYWwoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkg
ICAgICAgdTY0IHBlcnNpc3RlbnRfZmlkLCB1NjQgdm9sYXRpbGVfZmlkLCB1MzIgcGlkLCB1OCBp
bmZvX2NsYXNzLAogCSAgICAgICB1OCBpbmZvX3R5cGUsIHUzMiBhZGRpdGlvbmFsX2luZm8sIHVu
c2lnbmVkIGludCBudW0sCiAJCXZvaWQgKipkYXRhLCB1bnNpZ25lZCBpbnQgKnNpemUpCkBAIC00
OTQxLDYgKzUxMzksMjUgQEAgc2VuZF9zZXRfaW5mbyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBz
dHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCXJldHVybiByYzsKIH0KIAorc3RhdGljIGludAorc2Vu
ZF9zZXRfaW5mbyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29u
LAorCSAgICAgICB1NjQgcGVyc2lzdGVudF9maWQsIHU2NCB2b2xhdGlsZV9maWQsIHUzMiBwaWQs
IHU4IGluZm9fY2xhc3MsCisJICAgICAgIHU4IGluZm9fdHlwZSwgdTMyIGFkZGl0aW9uYWxfaW5m
bywgdW5zaWduZWQgaW50IG51bSwKKwkJdm9pZCAqKmRhdGEsIHVuc2lnbmVkIGludCAqc2l6ZSkK
K3sKKwlpbnQgcmM7CisKKwlkbyB7CisJCXJjID0gc2VuZF9zZXRfaW5mb19maW5hbCh4aWQsIHRj
b24sCisJCQkJcGVyc2lzdGVudF9maWQsIHZvbGF0aWxlX2ZpZCwKKwkJCQlwaWQsIGluZm9fY2xh
c3MsIGluZm9fdHlwZSwKKwkJCQlhZGRpdGlvbmFsX2luZm8sCisJCQkJbnVtLCBkYXRhLCBzaXpl
KTsKKwl9IHdoaWxlICh0Y29uLT5zZXMtPmNoYW5fY291bnQgPiAxICYmIHJjID09IC1FREVBRExL
KTsKKworCXJldHVybiByYzsKK30KKwogaW50CiBTTUIyX3NldF9lb2YoY29uc3QgdW5zaWduZWQg
aW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwgdTY0IHBlcnNpc3RlbnRfZmlkLAogCSAg
ICAgdTY0IHZvbGF0aWxlX2ZpZCwgdTMyIHBpZCwgX19sZTY0ICplb2YpCkBAIC00OTgwLDcgKzUx
OTcsNyBAQCBTTUIyX3NldF9lYShjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190
Y29uICp0Y29uLAogfQogCiBpbnQKLVNNQjJfb3Bsb2NrX2JyZWFrKGNvbnN0IHVuc2lnbmVkIGlu
dCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCitTTUIyX29wbG9ja19icmVha19maW5hbChj
b25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCQkgIGNvbnN0
IHU2NCBwZXJzaXN0ZW50X2ZpZCwgY29uc3QgdTY0IHZvbGF0aWxlX2ZpZCwKIAkJICBfX3U4IG9w
bG9ja19sZXZlbCkKIHsKQEAgLTUwMzAsNiArNTI0NywyMiBAQCBTTUIyX29wbG9ja19icmVhayhj
b25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCXJldHVybiBy
YzsKIH0KIAoraW50CitTTUIyX29wbG9ja19icmVhayhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBz
dHJ1Y3QgY2lmc190Y29uICp0Y29uLAorCQkgIGNvbnN0IHU2NCBwZXJzaXN0ZW50X2ZpZCwgY29u
c3QgdTY0IHZvbGF0aWxlX2ZpZCwKKwkJICBfX3U4IG9wbG9ja19sZXZlbCkKK3sKKwlpbnQgcmM7
CisKKwlkbyB7CisJCXJjID0gU01CMl9vcGxvY2tfYnJlYWtfZmluYWwoeGlkLCB0Y29uLAorCQkJ
CXBlcnNpc3RlbnRfZmlkLCB2b2xhdGlsZV9maWQsCisJCQkJb3Bsb2NrX2xldmVsKTsKKwl9IHdo
aWxlICh0Y29uLT5zZXMtPmNoYW5fY291bnQgPiAxICYmIHJjID09IC1FREVBRExLKTsKKworCXJl
dHVybiByYzsKK30KKwogdm9pZAogc21iMl9jb3B5X2ZzX2luZm9fdG9fa3N0YXRmcyhzdHJ1Y3Qg
c21iMl9mc19mdWxsX3NpemVfaW5mbyAqcGZzX2luZiwKIAkJCSAgICAgc3RydWN0IGtzdGF0ZnMg
KmtzdCkKQEAgLTUwOTcsNyArNTMzMCw3IEBAIGJ1aWxkX3Fmc19pbmZvX3JlcShzdHJ1Y3Qga3Zl
YyAqaW92LCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogfQogCiBpbnQKLVNNQjMxMV9wb3NpeF9x
ZnNfaW5mbyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAor
U01CMzExX3Bvc2l4X3Fmc19pbmZvX2ZpbmFsKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVj
dCBjaWZzX3Rjb24gKnRjb24sCiAJICAgICAgdTY0IHBlcnNpc3RlbnRfZmlkLCB1NjQgdm9sYXRp
bGVfZmlkLCBzdHJ1Y3Qga3N0YXRmcyAqZnNkYXRhKQogewogCXN0cnVjdCBzbWJfcnFzdCBycXN0
OwpAQCAtNTE0OCw3ICs1MzgxLDIxIEBAIFNNQjMxMV9wb3NpeF9xZnNfaW5mbyhjb25zdCB1bnNp
Z25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogfQogCiBpbnQKLVNNQjJfUUZT
X2luZm8oY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKK1NN
QjMxMV9wb3NpeF9xZnNfaW5mbyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190
Y29uICp0Y29uLAorCSAgICAgIHU2NCBwZXJzaXN0ZW50X2ZpZCwgdTY0IHZvbGF0aWxlX2ZpZCwg
c3RydWN0IGtzdGF0ZnMgKmZzZGF0YSkKK3sKKwlpbnQgcmM7CisKKwlkbyB7CisJCXJjID0gU01C
MzExX3Bvc2l4X3Fmc19pbmZvX2ZpbmFsKHhpZCwgdGNvbiwKKwkJCQlwZXJzaXN0ZW50X2ZpZCwg
dm9sYXRpbGVfZmlkLCBmc2RhdGEpOworCX0gd2hpbGUgKHRjb24tPnNlcy0+Y2hhbl9jb3VudCA+
IDEgJiYgcmMgPT0gLUVERUFETEspOworCisJcmV0dXJuIHJjOworfQorCitpbnQKK1NNQjJfUUZT
X2luZm9fZmluYWwoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNv
biwKIAkgICAgICB1NjQgcGVyc2lzdGVudF9maWQsIHU2NCB2b2xhdGlsZV9maWQsIHN0cnVjdCBr
c3RhdGZzICpmc2RhdGEpCiB7CiAJc3RydWN0IHNtYl9ycXN0IHJxc3Q7CkBAIC01MTk5LDcgKzU0
NDYsMjEgQEAgU01CMl9RRlNfaW5mbyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lm
c190Y29uICp0Y29uLAogfQogCiBpbnQKLVNNQjJfUUZTX2F0dHIoY29uc3QgdW5zaWduZWQgaW50
IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKK1NNQjJfUUZTX2luZm8oY29uc3QgdW5zaWdu
ZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKKwkgICAgICB1NjQgcGVyc2lzdGVu
dF9maWQsIHU2NCB2b2xhdGlsZV9maWQsIHN0cnVjdCBrc3RhdGZzICpmc2RhdGEpCit7CisJaW50
IHJjOworCisJZG8geworCQlyYyA9IFNNQjJfUUZTX2luZm9fZmluYWwoeGlkLCB0Y29uLAorCQkJ
CXBlcnNpc3RlbnRfZmlkLCB2b2xhdGlsZV9maWQsIGZzZGF0YSk7CisJfSB3aGlsZSAodGNvbi0+
c2VzLT5jaGFuX2NvdW50ID4gMSAmJiByYyA9PSAtRURFQURMSyk7CisKKwlyZXR1cm4gcmM7Cit9
CisKK2ludAorU01CMl9RRlNfYXR0cl9maW5hbChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1
Y3QgY2lmc190Y29uICp0Y29uLAogCSAgICAgIHU2NCBwZXJzaXN0ZW50X2ZpZCwgdTY0IHZvbGF0
aWxlX2ZpZCwgaW50IGxldmVsKQogewogCXN0cnVjdCBzbWJfcnFzdCBycXN0OwpAQCAtNTI4NCw3
ICs1NTQ1LDIxIEBAIFNNQjJfUUZTX2F0dHIoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0
IGNpZnNfdGNvbiAqdGNvbiwKIH0KIAogaW50Ci1zbWIyX2xvY2t2KGNvbnN0IHVuc2lnbmVkIGlu
dCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCitTTUIyX1FGU19hdHRyKGNvbnN0IHVuc2ln
bmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCisJICAgICAgdTY0IHBlcnNpc3Rl
bnRfZmlkLCB1NjQgdm9sYXRpbGVfZmlkLCBpbnQgbGV2ZWwpCit7CisJaW50IHJjOworCisJZG8g
eworCQlyYyA9IFNNQjJfUUZTX2F0dHJfZmluYWwoeGlkLCB0Y29uLAorCQkJCXBlcnNpc3RlbnRf
ZmlkLCB2b2xhdGlsZV9maWQsIGxldmVsKTsKKwl9IHdoaWxlICh0Y29uLT5zZXMtPmNoYW5fY291
bnQgPiAxICYmIHJjID09IC1FREVBRExLKTsKKworCXJldHVybiByYzsKK30KKworaW50CitzbWIy
X2xvY2t2X2ZpbmFsKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRj
b24sCiAJICAgY29uc3QgX191NjQgcGVyc2lzdF9maWQsIGNvbnN0IF9fdTY0IHZvbGF0aWxlX2Zp
ZCwgY29uc3QgX191MzIgcGlkLAogCSAgIGNvbnN0IF9fdTMyIG51bV9sb2NrLCBzdHJ1Y3Qgc21i
Ml9sb2NrX2VsZW1lbnQgKmJ1ZikKIHsKQEAgLTUzNDIsNiArNTYxNywyMiBAQCBzbWIyX2xvY2t2
KGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCiAJcmV0dXJu
IHJjOwogfQogCitpbnQKK3NtYjJfbG9ja3YoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0
IGNpZnNfdGNvbiAqdGNvbiwKKwkgICBjb25zdCBfX3U2NCBwZXJzaXN0X2ZpZCwgY29uc3QgX191
NjQgdm9sYXRpbGVfZmlkLCBjb25zdCBfX3UzMiBwaWQsCisJICAgY29uc3QgX191MzIgbnVtX2xv
Y2ssIHN0cnVjdCBzbWIyX2xvY2tfZWxlbWVudCAqYnVmKQoreworCWludCByYzsKKworCWRvIHsK
KwkJcmMgPSBzbWIyX2xvY2t2X2ZpbmFsKHhpZCwgdGNvbiwKKwkJCQlwZXJzaXN0X2ZpZCwgdm9s
YXRpbGVfZmlkLCBwaWQsCisJCQkJbnVtX2xvY2ssIGJ1Zik7IAorCX0gd2hpbGUgKHRjb24tPnNl
cy0+Y2hhbl9jb3VudCA+IDEgJiYgcmMgPT0gLUVERUFETEspOworCisJcmV0dXJuIHJjOworfQor
CiBpbnQKIFNNQjJfbG9jayhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29u
ICp0Y29uLAogCSAgY29uc3QgX191NjQgcGVyc2lzdF9maWQsIGNvbnN0IF9fdTY0IHZvbGF0aWxl
X2ZpZCwgY29uc3QgX191MzIgcGlkLApAQCAtNTM2MCw3ICs1NjUxLDcgQEAgU01CMl9sb2NrKGNv
bnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCiB9CiAKIGludAot
U01CMl9sZWFzZV9icmVhayhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29u
ICp0Y29uLAorU01CMl9sZWFzZV9icmVha19maW5hbChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBz
dHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCQkgX191OCAqbGVhc2Vfa2V5LCBjb25zdCBfX2xlMzIg
bGVhc2Vfc3RhdGUpCiB7CiAJc3RydWN0IHNtYl9ycXN0IHJxc3Q7CkBAIC01NDE4LDMgKzU3MDks
MTcgQEAgU01CMl9sZWFzZV9icmVhayhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lm
c190Y29uICp0Y29uLAogCiAJcmV0dXJuIHJjOwogfQorCitpbnQKK1NNQjJfbGVhc2VfYnJlYWso
Y29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKKwkJIF9fdTgg
KmxlYXNlX2tleSwgY29uc3QgX19sZTMyIGxlYXNlX3N0YXRlKQoreworCWludCByYzsKKworCWRv
IHsKKwkJcmMgPSBTTUIyX2xlYXNlX2JyZWFrX2ZpbmFsKHhpZCwgdGNvbiwKKwkJCQlsZWFzZV9r
ZXksIGxlYXNlX3N0YXRlKTsKKwl9IHdoaWxlICh0Y29uLT5zZXMtPmNoYW5fY291bnQgPiAxICYm
IHJjID09IC1FREVBRExLKTsKKworCXJldHVybiByYzsKK30KLS0gCjIuMjUuMQoK
--0000000000008a2cf805c0e28022--
